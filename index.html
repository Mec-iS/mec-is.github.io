<!DOCTYPE html>
<html prefix="
og: http://ogp.me/ns#
article: http://ogp.me/ns/article#
" lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="A Blog About Learning Python">
<meta name="viewport" content="width=device-width">
<title>pyHummus | pyHummus</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
<link rel="canonical" href="http://mec-is.github.io/">
<link rel="icon" href="favicon.ico" sizes="16x16">
<!--[if lt IE 9]><script src="/assets/js/html5.js"></script><![endif]--><style>
    div.input_prompt {
      display: none;
    }
    </style>
</head>
<body>
    <section class="social"><ul>
<li><a href="#" title="Home"><i class="icon-home"></i></a></li>
            <li><a href="archive.html" title="Archives"><i class="icon-folder-open-alt"></i></a></li>
            <li><a href="categories/index.html" title="Tags"><i class="icon-tags"></i></a></li>
            <li><a href="https://profiles.udacity.com/u/lorenzomoriondo" title="Me At Udacity"><i class="icon-user"></i></a></li>
            <li><a href="https://twitter.com/lorenzogotuned" title="My Twitter"><i class="icon-twitter"></i></a></li>
            <li><a href="https://it.linkedin.com/in/lorenzomoriondo" title="My LinkedIn"><i class="icon-linkedin"></i></a></li>

        <li>        <footer id="footer" role="contentinfo"><p>2015 Content collected and organized by         <a href="mailto:tunedconsulting@gmail.com">lorenzogotuned</a>   Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>      This material has been collected for learning purposes only and no commercial use. All rights reserved to sources.</p>
            
        </footer>
</li>
        </ul></section><section class="page-content"><div class="content" rel="main">
    <h1 style="letter-spacing: 3px;">pyHummus: Python Learning Dip</h1>
    <div class="post">
        <p style="font-family: monospace; font-size: 90%;">This is a collection of all the interesting things I have found during my Python learning experience, collected into IPython notebooks. These are basically only annotations and code: it's up to you to read, take some partial knowledge and structure the content for your own sake. I give you here the <i>best ingredients I could find, happy cooking with Python!</i></p>
    </div>
    <div style="min-height: 30px; margin-top: 10px;">
        <a href="https://twitter.com/share" class="twitter-share-button" data-via="lorenzogotuned" data-hashtags="Python, coding">Tweet</a><script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
</div>
    <div style="min-height: 30px;">
        <script type="text/javascript" src="http://platform.linkedin.com/in.js"></script><script type="in/share" data-counter="right"></script>
</div>
        <div class="post">
            <h1 class="title"><a href="posts/asyncio-first-look/">Asyncio First Look</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2015-10-19T16:08:39+02:00">2015-10-19 16:08</time>
</div>
                <div class="stats">
                    
                </div>
                        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/networking/" rel="tag">Networking</a></li>
        </ul>
</div>

            </div>
            <!-- <div class="body">
                <div><h3>Definitions</h3>
<ul>
<li>A Good explanation for <a href="http://stackoverflow.com/a/5201906/2536357"><em>Threading</em></a></li>
<li>"A piece of code is <em>thread-safe</em> if it functions correctly during simultaneous execution by multiple threads." (Wikipedia). For a discussion about how thread-safety is strictly connected to scenarios in which specific objectives are pursued (accessing/modifying mutable data-structures for example), see <a href="http://blogs.msdn.com/b/ericlippert/archive/2009/10/19/what-is-this-thing-you-call-thread-safe.aspx">here</a>. The author sustains that thread-safety is strictly related to the tasks the software performs. It can be, or not, thread-safe related to what it is performing, and not just generically thread-safe.  </li>
</ul>
<h4>Generators coroutines and async coroutines</h4>
<p><em>from <a href="https://docs.python.org/3/library/asyncio-task.html">Pydocs</a></em>:</p>
<p>"Coroutines used with <strong>asyncio</strong> may be implemented using the <strong>async def</strong> statement, or by using <strong>generators</strong>."</p>
<p>"Generator-based coroutines use the <strong>yield from</strong> syntax introduced in <a href="http://www.python.org/dev/peps/pep-0380">PEP 380</a>, instead of the original yield syntax."</p>
<h5>Disambiguation</h5>
<ul>
<li>
<p>The <strong>function</strong> that defines a coroutine (a function definition using async def or decorated with @asyncio.coroutine). If disambiguation is needed we will call this a coroutine function (iscoroutinefunction() returns True).</p>
</li>
<li>
<p>The <strong>object</strong> obtained by calling a coroutine function. This object represents a computation or an I/O operation (usually a combination) that will complete eventually. If disambiguation is needed we will call it a coroutine object (iscoroutine() returns True).</p>
</li>
</ul>
<h5>Basics</h5>
<p>"Calling a coroutine does not start its code running. Calling a coroutine does not start its code running – the coroutine object returned by the call doesn’t do anything until you schedule its execution."</p>
<p>Things a coroutine can do:</p>
<p><em>result = await future</em> or <em>result = yield from future</em> – suspends the coroutine until the future is done, then returns the future’s result, or raises an exception, which will be propagated. (If the future is cancelled, it will raise a CancelledError exception.) Note that tasks are futures, and everything said about futures also applies to tasks.</p>
<p><em>result = await coroutine</em> or <em>result = yield from coroutine</em> – wait for another coroutine to produce a result (or raise an exception, which will be propagated). The coroutine expression must be a call to another coroutine.</p>
<p><em>return expression</em> – produce a result to the coroutine that is waiting for this one using await or yield from.</p>
<p><em>raise exception</em> – raise an exception in the coroutine that is waiting for this one using await or yield from.</p>
<h5>Example: Two async coroutines</h5>
<pre class="code literal-block"><span class="kn">import</span> <span class="nn">asyncio</span>

<span class="n">async</span> <span class="k">def</span> <span class="nf">compute</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Compute </span><span class="si">%s</span><span class="s"> + </span><span class="si">%s</span><span class="s"> ..."</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
    <span class="n">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>

<span class="n">async</span> <span class="k">def</span> <span class="nf">print_sum</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">await</span> <span class="n">compute</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="si">%s</span><span class="s"> + </span><span class="si">%s</span><span class="s"> = </span><span class="si">%s</span><span class="s">"</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>

<span class="n">loop</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">get_event_loop</span><span class="p">()</span>
<span class="n">loop</span><span class="o">.</span><span class="n">run_until_complete</span><span class="p">(</span><span class="n">print_sum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">loop</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre>


<ul>
<li>
<p><code>await compute</code> makes <code>print_sum</code> to wait for the coroutine to complete.</p>
</li>
<li>
<p>The loop is created by the <code>BaseEventLoop.run_until_complete()</code> method when it gets a <u>coroutine object instead of a task.</u></p>
</li>
<li>
<p>see <a href="https://docs.python.org/3/library/asyncio-eventloop.html">BaseEventLoop</a></p>
</li>
</ul>
<h4>Future</h4>
<p>Construct used for synchronization in concurrent operations. "... describe an object that acts as a proxy for a result that is initially unknown, usually because the computation of its value is yet incomplete."(Wikipedia)</p>
<p>Return a result or an exception when it's done. If invoked can raise different exceptions defining its actual state (None, InvalidStateError, CancelledError). Can have a callback to be run when it's done. "<code>result()</code> and <code>exception()</code> methods do not take a timeout argument and raise an exception when the future isn’t done yet."</p>
<h4>Task</h4>
<p>"A task is responsible for executing a coroutine object in an event loop. If the wrapped coroutine yields from a future, the task suspends the execution of the wrapped coroutine and waits for the completition of the future. When the future is done, the execution of the wrapped coroutine restarts with the result or the exception of the future."</p>
<p>"Event loops use cooperative scheduling: an event loop only runs one task at a time. Other tasks may run in parallel if other event loops are running in different threads. While a task waits for the completion of a future, the event loop executes a new task."</p>
<p><u>Important:</u> "Don’t directly create Task instances: use the <code>ensure_future()</code> function or the <code>BaseEventLoop.create_task()</code> method."</p></div>
            </div> -->
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/algorithms-generalization-shortest-path-lowest-cost/">Algorithms Generalization Shortest Path Lowest Cost</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2015-08-25T17:32:36+02:00">2015-08-25 17:32</time>
</div>
                <div class="stats">
                    
                </div>
                        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/algorithms/" rel="tag">Algorithms</a></li>
        </ul>
</div>

            </div>
            <!-- <div class="body">
                <div><h3>Shortest Path Search</h3>
<h4>Basic concepts: starting state, successor function, goal</h4>
<p><img alt="Components for Shortest-Path-Search" src="/assets/images/posts/shortest-path-search.png"></p>
<p>Using frontier's analysis:</p>
<pre class="code literal-block"><span class="c">####### Missionaries and Cannibals Game #######</span>
<span class="c"># By Peter Norvig, Udacity.com CS212 Lesson 4</span>
<span class="c"># -----------------</span>
<span class="c"># User Instructions</span>
<span class="c"># </span>
<span class="c"># Write a function, mc_problem2, that solves the missionary and cannibal</span>
<span class="c"># problem by making a call to shortest_path_search. Add any code below</span>
<span class="c"># and change the arguments in the return statement's call to the </span>
<span class="c"># shortest_path_search function.</span>

<span class="k">def</span> <span class="nf">mc_problem2</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">goal</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="c"># your code here if necessary</span>
    <span class="k">if</span> <span class="n">goal</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">goal</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">start</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">shortest_path_search</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">csuccessors</span><span class="p">,</span> <span class="n">all_gone</span><span class="p">)</span> <span class="c"># &lt;== insert arguments here</span>

<span class="k">def</span> <span class="nf">all_gone</span><span class="p">(</span><span class="n">state</span><span class="p">):</span> <span class="k">return</span> <span class="n">state</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">shortest_path_search</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">successors</span><span class="p">,</span> <span class="n">is_goal</span><span class="p">):</span>
    <span class="sd">"""Find the shortest path from start state to a state</span>
<span class="sd">    such that is_goal(state) is true."""</span>
    <span class="k">if</span> <span class="n">is_goal</span><span class="p">(</span><span class="n">start</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">start</span><span class="p">]</span>
    <span class="n">explored</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="n">frontier</span> <span class="o">=</span> <span class="p">[</span> <span class="p">[</span><span class="n">start</span><span class="p">]</span> <span class="p">]</span> 
    <span class="k">while</span> <span class="n">frontier</span><span class="p">:</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">frontier</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">path</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span> <span class="ow">in</span> <span class="n">successors</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">state</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">explored</span><span class="p">:</span>
                <span class="n">explored</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
                <span class="n">path2</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="p">[</span><span class="n">action</span><span class="p">,</span> <span class="n">state</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">is_goal</span><span class="p">(</span><span class="n">state</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">path2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">frontier</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">path2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Fail</span>
<span class="n">Fail</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">def</span> <span class="nf">csuccessors</span><span class="p">(</span><span class="n">state</span><span class="p">):</span>
    <span class="sd">"""Find successors (including those that result in dining) to this</span>
<span class="sd">    state. But a state where the cannibals can dine has no successors."""</span>
    <span class="n">M1</span><span class="p">,</span> <span class="n">C1</span><span class="p">,</span> <span class="n">B1</span><span class="p">,</span> <span class="n">M2</span><span class="p">,</span> <span class="n">C2</span><span class="p">,</span> <span class="n">B2</span> <span class="o">=</span> <span class="n">state</span>
    <span class="c">## Check for state with no successors</span>
    <span class="k">if</span> <span class="n">C1</span> <span class="o">&gt;</span> <span class="n">M1</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">C2</span> <span class="o">&gt;</span> <span class="n">M2</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{}</span>
    <span class="n">items</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">B1</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">items</span> <span class="o">+=</span> <span class="p">[(</span><span class="n">sub</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">delta</span><span class="p">),</span> <span class="n">a</span> <span class="o">+</span> <span class="s">'-&gt;'</span><span class="p">)</span>
                  <span class="k">for</span> <span class="n">delta</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">deltas</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
    <span class="k">if</span> <span class="n">B2</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">items</span> <span class="o">+=</span> <span class="p">[(</span><span class="n">add</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">delta</span><span class="p">),</span> <span class="s">'&lt;-'</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span>
                  <span class="k">for</span> <span class="n">delta</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">deltas</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">):</span>
    <span class="s">"add two vectors, X and Y."</span>
    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">y</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">sub</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">):</span>
    <span class="s">"subtract vector Y from X."</span>
    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">y</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">))</span>

<span class="n">deltas</span> <span class="o">=</span> <span class="p">{(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>    <span class="o">-</span><span class="mi">2</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span> <span class="s">'MM'</span><span class="p">,</span>
          <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>     <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span> <span class="s">'CC'</span><span class="p">,</span>
          <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>    <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span> <span class="s">'MC'</span><span class="p">,</span>
          <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>    <span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span> <span class="s">'M'</span><span class="p">,</span>
          <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>     <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span> <span class="s">'C'</span><span class="p">}</span>

<span class="k">def</span> <span class="nf">test</span><span class="p">():</span>
    <span class="k">assert</span> <span class="n">mc_problem2</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="o">==</span> <span class="p">[</span>
                             <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="s">'MC-&gt;'</span><span class="p">,</span>
                             <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>
    <span class="k">assert</span> <span class="n">mc_problem2</span><span class="p">()</span> <span class="o">==</span> <span class="p">[(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="s">'CC-&gt;'</span><span class="p">,</span> 
                             <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="s">'&lt;-C'</span><span class="p">,</span> 
                             <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="s">'CC-&gt;'</span><span class="p">,</span> 
                             <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="s">'&lt;-C'</span><span class="p">,</span> 
                             <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="s">'MM-&gt;'</span><span class="p">,</span> 
                             <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="s">'&lt;-MC'</span><span class="p">,</span> 
                             <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="s">'MM-&gt;'</span><span class="p">,</span> 
                             <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="s">'&lt;-C'</span><span class="p">,</span> 
                             <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="s">'CC-&gt;'</span><span class="p">,</span> 
                             <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="s">'&lt;-C'</span><span class="p">,</span> 
                             <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="s">'CC-&gt;'</span><span class="p">,</span> 
                             <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>
    <span class="k">return</span> <span class="s">'tests pass'</span>

<span class="k">print</span> <span class="n">test</span><span class="p">()</span> 
</pre>


<h3>Lowest Cost Search</h3>
<h5>Each movement on the path can have different cost</h5>
<p><img alt="Components for Lowest-Cost-Search" src="/assets/images/posts/lowest-cost-search.png"></p>
<pre class="code literal-block"><span class="c">####### The Bridge Game #######</span>
<span class="c"># By Peter Norvig, Udacity.com CS212 Lesson 4</span>
<span class="c"># -----------------</span>
<span class="c"># User Instructions</span>
<span class="c"># </span>
<span class="c"># In this problem, you will generalize the bridge problem </span>
<span class="c"># by writing a function bridge_problem3, that makes a call</span>
<span class="c"># to lowest_cost_search.</span>

<span class="k">def</span> <span class="nf">bridge_problem3</span><span class="p">(</span><span class="n">here</span><span class="p">):</span>
    <span class="sd">"""Find the fastest (least elapsed time) path to </span>
<span class="sd">    the goal in the bridge problem."""</span>
    <span class="n">start</span> <span class="o">=</span> <span class="p">(</span><span class="nb">frozenset</span><span class="p">(</span><span class="n">here</span><span class="p">)</span> <span class="o">|</span> <span class="nb">frozenset</span><span class="p">([</span><span class="s">'light'</span><span class="p">]),</span> <span class="nb">frozenset</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">lowest_cost_search</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">bsuccessor2</span><span class="p">,</span> <span class="n">all_over</span><span class="p">,</span> <span class="n">bcost</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">all_over</span><span class="p">(</span><span class="n">state</span><span class="p">):</span>
    <span class="n">here</span><span class="p">,</span> <span class="n">there</span> <span class="o">=</span> <span class="n">state</span>
    <span class="k">return</span> <span class="ow">not</span> <span class="n">here</span> <span class="ow">or</span> <span class="n">here</span> <span class="o">==</span> <span class="nb">set</span><span class="p">([</span><span class="s">'light'</span><span class="p">])</span> 

<span class="k">def</span> <span class="nf">lowest_cost_search</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">successors</span><span class="p">,</span> <span class="n">is_goal</span><span class="p">,</span> <span class="n">action_cost</span><span class="p">):</span>
    <span class="sd">"""Return the lowest cost path, starting from start state,</span>
<span class="sd">    and considering successors(state) =&gt; {state:action,...},</span>
<span class="sd">    that ends in a state for which is_goal(state) is true,</span>
<span class="sd">    where the cost of a path is the sum of action costs,</span>
<span class="sd">    which are given by action_cost(action)."""</span>
    <span class="n">Fail</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">explored</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span> <span class="c"># set of states we have visited</span>
    <span class="n">frontier</span> <span class="o">=</span> <span class="p">[</span> <span class="p">[</span><span class="n">start</span><span class="p">]</span> <span class="p">]</span> <span class="c"># ordered list of paths we have blazed</span>
    <span class="k">while</span> <span class="n">frontier</span><span class="p">:</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">frontier</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">state1</span> <span class="o">=</span> <span class="n">final_state</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_goal</span><span class="p">(</span><span class="n">state1</span><span class="p">):</span>  
            <span class="k">return</span> <span class="n">path</span>
        <span class="n">explored</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">state1</span><span class="p">)</span>
        <span class="n">pcost</span> <span class="o">=</span> <span class="n">path_cost</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span> <span class="ow">in</span> <span class="n">successors</span><span class="p">(</span><span class="n">state1</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">state</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">explored</span><span class="p">:</span>
                <span class="n">total_cost</span> <span class="o">=</span> <span class="n">pcost</span> <span class="o">+</span> <span class="n">action_cost</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
                <span class="n">path2</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="p">[(</span><span class="n">action</span><span class="p">,</span> <span class="n">total_cost</span><span class="p">),</span> <span class="n">state</span><span class="p">]</span>
                <span class="n">add_to_frontier</span><span class="p">(</span><span class="n">frontier</span><span class="p">,</span> <span class="n">path2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Fail</span>

<span class="k">def</span> <span class="nf">final_state</span><span class="p">(</span><span class="n">path</span><span class="p">):</span> <span class="k">return</span> <span class="n">path</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">path_cost</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
    <span class="s">"The total cost of a path (which is stored in a tuple with the final action)."</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">action</span><span class="p">,</span> <span class="n">total_cost</span> <span class="o">=</span> <span class="n">path</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">total_cost</span>

<span class="k">def</span> <span class="nf">add_to_frontier</span><span class="p">(</span><span class="n">frontier</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
    <span class="s">"Add path to frontier, replacing costlier path if there is one."</span>
    <span class="c"># (This could be done more efficiently.)</span>
    <span class="c"># Find if there is an old path to the final state of this path.</span>
    <span class="n">old</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">frontier</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">final_state</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">==</span> <span class="n">final_state</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
            <span class="n">old</span> <span class="o">=</span> <span class="n">i</span>
            <span class="k">break</span>
    <span class="k">if</span> <span class="n">old</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">path_cost</span><span class="p">(</span><span class="n">frontier</span><span class="p">[</span><span class="n">old</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">path_cost</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
        <span class="k">return</span> <span class="c"># Old path was better; do nothing</span>
    <span class="k">elif</span> <span class="n">old</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">del</span> <span class="n">frontier</span><span class="p">[</span><span class="n">old</span><span class="p">]</span> <span class="c"># Old path was worse; delete it</span>
    <span class="c">## Now add the new path and re-sort</span>
    <span class="n">frontier</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="n">frontier</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">path_cost</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">bsuccessors2</span><span class="p">(</span><span class="n">state</span><span class="p">):</span>
    <span class="sd">"""Return a dict of {state:action} pairs.  A state is a (here, there) tuple,</span>
<span class="sd">    where here and there are frozensets of people (indicated by their times) and/or</span>
<span class="sd">    the light."""</span>
    <span class="n">here</span><span class="p">,</span> <span class="n">there</span> <span class="o">=</span> <span class="n">state</span>
    <span class="k">if</span> <span class="s">'light'</span> <span class="ow">in</span> <span class="n">here</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="p">(((</span><span class="n">here</span>  <span class="o">-</span> <span class="nb">frozenset</span><span class="p">([</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="s">'light'</span><span class="p">]),</span>
                      <span class="n">there</span> <span class="o">|</span> <span class="nb">frozenset</span><span class="p">([</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="s">'light'</span><span class="p">])),</span>
                     <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="s">'-&gt;'</span><span class="p">))</span>
                    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">here</span> <span class="k">if</span> <span class="n">a</span> <span class="ow">is</span> <span class="ow">not</span> <span class="s">'light'</span>
                    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">here</span> <span class="k">if</span> <span class="n">b</span> <span class="ow">is</span> <span class="ow">not</span> <span class="s">'light'</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="p">(((</span><span class="n">here</span>  <span class="o">|</span> <span class="nb">frozenset</span><span class="p">([</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="s">'light'</span><span class="p">]),</span>
                      <span class="n">there</span> <span class="o">-</span> <span class="nb">frozenset</span><span class="p">([</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="s">'light'</span><span class="p">])),</span>
                     <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="s">'&lt;-'</span><span class="p">))</span>
                    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">there</span> <span class="k">if</span> <span class="n">a</span> <span class="ow">is</span> <span class="ow">not</span> <span class="s">'light'</span>
                    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">there</span> <span class="k">if</span> <span class="n">b</span> <span class="ow">is</span> <span class="ow">not</span> <span class="s">'light'</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">bcost</span><span class="p">(</span><span class="n">action</span><span class="p">):</span>
    <span class="s">"Returns the cost (a number) of an action in the bridge problem."</span>
    <span class="c"># An action is an (a, b, arrow) tuple; a and b are times; arrow is a string</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">arrow</span> <span class="o">=</span> <span class="n">action</span>
    <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">test</span><span class="p">():</span>
    <span class="n">here</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
    <span class="k">assert</span> <span class="n">bridge_problem3</span><span class="p">(</span><span class="n">here</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span>
            <span class="p">(</span><span class="nb">frozenset</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s">'light'</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span> <span class="nb">frozenset</span><span class="p">([])),</span> 
            <span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">'-&gt;'</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> 
            <span class="p">(</span><span class="nb">frozenset</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span> <span class="nb">frozenset</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s">'light'</span><span class="p">])),</span> 
            <span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s">'&lt;-'</span><span class="p">),</span> <span class="mi">4</span><span class="p">),</span> 
            <span class="p">(</span><span class="nb">frozenset</span><span class="p">([</span><span class="s">'light'</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span> <span class="nb">frozenset</span><span class="p">([</span><span class="mi">1</span><span class="p">])),</span> 
            <span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s">'-&gt;'</span><span class="p">),</span> <span class="mi">14</span><span class="p">),</span> 
            <span class="p">(</span><span class="nb">frozenset</span><span class="p">([</span><span class="mi">2</span><span class="p">]),</span> <span class="nb">frozenset</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s">'light'</span><span class="p">])),</span> 
            <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">'&lt;-'</span><span class="p">),</span> <span class="mi">15</span><span class="p">),</span> 
            <span class="p">(</span><span class="nb">frozenset</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s">'light'</span><span class="p">]),</span> <span class="nb">frozenset</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">])),</span> 
            <span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">'-&gt;'</span><span class="p">),</span> <span class="mi">17</span><span class="p">),</span> 
            <span class="p">(</span><span class="nb">frozenset</span><span class="p">([]),</span> <span class="nb">frozenset</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s">'light'</span><span class="p">]))]</span>
    <span class="k">return</span> <span class="s">'test passes'</span>

<span class="k">print</span> <span class="n">test</span><span class="p">()</span>
</pre></div>
            </div> -->
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/curl/">Curl</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2015-08-05T14:16:56+02:00">2015-08-05 14:16</time>
</div>
                <div class="stats">
                    
                </div>
                        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/curl/" rel="tag">Curl</a></li>
           <li><a class="tag p-category" href="categories/networking/" rel="tag">Networking</a></li>
           <li><a class="tag p-category" href="categories/testing/" rel="tag">Testing</a></li>
        </ul>
</div>

            </div>
            <!-- <div class="body">
                <div><h5>Example of POSTing with cURL</h5>
<pre class="code literal-block"><span class="nv">$ </span>curl -i -X POST url.com/post_here -F <span class="s2">"some_parameter1=&lt;some_file.ext"</span> -F <span class="s2">"some_parameter2=abc"</span>
</pre>


<h5>pycURL</h5>
<p>... more to come, under-construction</p></div>
            </div> -->
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/devops-basics/">Devops Basics</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2015-08-05T11:44:28+02:00">2015-08-05 11:44</time>
</div>
                <div class="stats">
                    
                </div>
                        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/devops/" rel="tag">DevOps</a></li>
        </ul>
</div>

            </div>
            <!-- <div class="body">
                <div><p><img alt="DevOps - CAMS" src="/assets/images/posts/devops1.png"><br><br></p>
<p><img alt="DevOps - Packer: from VM to an artifact" src="/assets/images/posts/devops2.png"><br><br></p>
<h3>Additional resources</h3>
<h4>Notable Books</h4>
<ul>
<li><a href="http://itrevolution.com/books/phoenix-project-devops-book/">The Phoenix Project</a> (by Gene Kim, Kevin Behr, George Spafford) - A Novel About IT, DevOps, and Helping Your Business Win</li>
<li><a href="http://www.amazon.com/Continuous-Delivery-Deployment-Automation-Addison-Wesley-ebook/dp/B003YMNVC0">Continuous Delivery: Reliable Software Releases through Build, Test, and Deployment Automation</a> (by Jez Humble, David Farley) - The principles and technical practices that enable
rapid, incremental delivery of high quality, valuable new functionality to users.</li>
<li><a href="http://www.amazon.com/Lean-Enterprise-Performance-Organizations-Innovate/dp/1449368425">Lean Enterprise: How High Performance Organizations Innovate at Scale </a> (by Jez Humble, Joanne Molesky, Barry O'Reilly) - Lean and Agile principles and patterns to help you move fast at scale - and demonstrates why and how to apply these methodologies throughout your organization, rather than with just one department or team.</li>
<li><a href="http://smile.amazon.com/gp/product/B00CBM1WFC">Building a DevOps Culture</a> (by Mandi Walls) - Free Kindle book - DevOps is as much about culture as it is about tools</li>
</ul>
<h4>Notable Presentations</h4>
<ul>
<li><a href="https://www.youtube.com/watch?v=o7-IuYS0iSE">Short history of DevOps</a> - video by Damon Edwards</li>
<li><a href="https://www.youtube.com/watch?v=_DEToXsgrPc">Chef Style DevOps Kungfu</a> - Adam Jacob Keynote - ChefConf 2015</li>
<li><a href="https://www.youtube.com/watch?v=L1w2_AY82WY">Jez Humble Keynote</a> - ChefConf 2015</li>
<li><a href="https://vimeo.com/69079272">Leading the Horses to Drink</a> - Support and Initiate a DevOps transformation by Damon Edwards.</li>
</ul>
<h4>Additional DevOps related blogs and sites</h4>
<ul>
<li><a href="https://www.chef.io/blog/2010/07/16/what-devops-means-to-me/">What DevOps means to me</a> - an explanation of the components that make up CAMS (Culture, Automation, Measurement, Sharing), as well additional thoughts on what DevOps is and is not - by John Willis</li>
<li><a href="http://dev2ops.org/">dev2ops</a> - Delivering Change in a DevOps and Cloud World</li>
<li><a href="http://theagileadmin.com/">the agile admin</a> - blog on topics of DevOps, agile operations, cloud computing, infrastructure automation, Web security (especially AppSec), transparency, open source, monitoring, Web performance optimization, and more.</li>
<li><a href="http://devopschecklist.com/">The DevOps checklist</a> - This checklist is comprised of 48 items you can use to gauge the maturity of your software delivery competency, and form a baseline to measure your future improvements.</li>
<li><a href="http://www.mattstratton.com/">DevOps – A Crash Course</a> by Matt Stratton. A lot of links to good resources on DevOps topics.</li>
</ul>
<h4>Additional Resources by Nutanix</h4>
<ul>
<li><a href="http://stevenpoitras.com/the-nutanix-bible/">The Nutanix Bible</a> - Brief History of datacenters, virtualisation, webscale architecture and an explanation of Nutanix hyperconverged architecture.</li>
<li><a href="http://go.nutanix.com/webscale-101-hyper-converged-infrastructure-guide.html">Hyperconverged Infrastructure Guide</a></li>
<li><a href="http://www.nutanix.com/company/education/">Nutanix Education portal</a></li>
<li><a href="https://www.youtube.com/channel/UCJupSMWQRKQTvkb2CfkW0Eg">Nutanix Education YouTube channel</a></li>
<li><a href="http://next.nutanix.com/">Nutanix NEXT community site</a></li>
</ul></div>
            </div> -->
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/networking-basics/">Networking Basics</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2015-07-29T17:35:22+02:00">2015-07-29 17:35</time>
</div>
                <div class="stats">
                    
                </div>
                        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/devops/" rel="tag">DevOps</a></li>
           <li><a class="tag p-category" href="categories/networking/" rel="tag">Networking</a></li>
        </ul>
</div>

            </div>
            <!-- <div class="body">
                <div><p>Thanks to <a href="http://online.stanford.edu/course/introduction-computer-networking">Stanford Online</a><br></p>
<h2>Networks Layers (ISO-OSI)</h2>
<p><img alt="OSI 4 layers communication" src="/assets/images/posts/ISO-flow.png"></p>
<h3>Network Layer</h3>
<p>Delivers packets to computers</p>
<p><img alt="IP in OSI" src="/assets/images/posts/ISO-4.png"></p>
<h4>Internet Protocol: characteristics</h4>
<ul>
<li>IP is a <em>datagram service</em>. Datagrams are self-contained: data and header (destination address + source address). Datagrams are delivered hop-by-hop (node-to-node, router-to-router). Routers have forwarding tables for different IP addresses, they know only the next hop for the datagram in the packet.</li>
<li>IP is <em>unreliable</em>. Packets may get lost or dropped, or simply delivered out of sequence compared with the sending sequence.</li>
<li>IP guarantees the <em>best effort</em>: packets will be dropped only when necessary (recovery these errors is on Transport, or Link).</li>
<li>IP is <em>connectionless</em>. It maintains no knowledge at all of the state or sent datagrams </li>
</ul>
<p><br><br>
The IP layer does not guarantee that packets will be delivered in order or always follow the same path through the network. Each packet is individually routed. Often, all the packets in a flow <em>do</em> follow the same path. But the path may change if a link fails and packets follow a new path. Or if a router load-balances packets, packet-by-packet over several different output links.</p>
<h4>Internet Protocol: model and features</h4>
<ul>
<li>IP is a deliberately simple service, to work on different kinds of physical infrastructure</li>
<li>IP tries to prevent pakets looping forever (usually due to updates in forwarding tables), using the hop-count field in the datagram (TTL field).</li>
<li>IP limits packets size depending on the underlying Link (different networks have different max-size for packets, Network layers in routers fragments packets exceed max-size)</li>
<li>IP uses checksums to check the header is not being corrupted and the destination is right</li>
</ul>
<h4>IPv4 Datagram</h4>
<p><img alt="IP in OSI" src="/assets/images/posts/ipv4-datagram.png"><br><br></p>
<p>You can experience the different hops walked by a packed with the <em>traceroute</em> command (<code>$&gt; traceroute -w 1 www.google.com</code>)</p>
<h3>Transport Layer</h3>
<p>delivers data to applications</p>
<h4>TCP Byte Stream</h4>
<p>Client and server establish a communication using the three-way-handshake (SYN &gt; SYN/ACK &gt; ACK):</p>
<ul>
<li>client sends a "synchronize" (SYN)</li>
<li>server responds with a "synchronize/acknowledge" (SYN/ACK)</li>
<li>client responds with an "acknowledge" (ACK)</li>
</ul>
<p>Everybody can interact and learn about this behaviour with software like (Wireshark)[https://www.wireshark.org/]</p>
<h3>Packets</h3>
<p>Packet switching, Layering, Encapsulation</p>
<h4>Packet Switching</h4>
<p><em>Reminder</em>: packets are self-contained, independent chunks of communication. <br><br>
Flow: a collection of datagrams belonging to the same end-to-end communication (e.g. a TCP connection).<br><br></p>
<p>Packet switching principle in a common router: <em>Independently, for each arriving packet, pick its outgoing link. If the link is free, send it. Else, hold the packet for later.</em>. <br><br></p>
<p>This principle has important consequences:</p>
<ul>
<li>simple packet forwarding: each router has its own forwarding table, that defines the next hop to the destination defined in the packet.</li>
<li>efficient sharing of links (lines between hops): many different packets from different users/connections can share the same link.</li>
<li>considering that data traffic is bursty. packet switching allows to use all available link capacity and to share link capacity. This is called <em>statistical multiplexing</em>.</li>
</ul>
<h4>Layering</h4>
<p>Layering is a well-know structure for computer and network systems</p>
<p><img alt="Layers" src="/assets/images/posts/layering1.png"><br><br></p>
<p>Example of use layering outside networks:<br>
<img alt="Layers in computer systems" src="/assets/images/posts/layering2.png"><br><br></p>
<p>Five main reason for Layering:</p>
<ul>
<li>Modularity: It breaks down the system into smaller, more manageable modules</li>
<li>Well defined services: Each layer provides a well defined service to the layer above</li>
<li>Reuse: A layer above can rely on all the hard work put in by others to implement the layers below</li>
<li>Separation of concerns: Each layer can focus on its own job, without having to worry about how other layers do theirs </li>
<li>Continous improvement (ex. cross-layer optimization)</li>
<li>A 6th benefit is specific to layered communication systems, such as the Internet. That is peer to peer communications</li>
</ul>
<h4>Encapsulation</h4>
<p>When you send a TCP segment, for example, it’s inside an IP packet, which is inside an Ethernet frame. Encapsulation is how this works. Encapsulation is the principle by which you organize information in packets so that you can maintain layers, yet let them share the contents of your packets.<br><br></p>
<p>The way this works is each protocol layer has some headers, followed by its payload.<br><br></p>
<p><em>Example</em>: <u>A HTTP GET request of a Wi-Fi Ethernet</u>: The HTTP GET request is the payload of a TCP segment. The TCP segment, encapsulating the HTTP GET, is the payload of an IP packet. This IP packet, encapsulating the TCP segment and the HTTP GET, is the payload of a Wi-Fi frame. <br><br></p>
<p><img alt="Encapsulation of a HTTP GET" src="/assets/images/posts/encapsulation1.png"><br><br>
<em>Image</em>: This is how WireShark represent the example above, each line represents the different layers' payloads (from bottom to top: the application layer with the HTTP request, the transport layer with the TCP segment, the IP layer with the datagram, and the Ethernet frame).<br><br></p>
<p><em>Example</em>: <u>VPN</u>: HTTP inside TCP inside IP inside TLS inside TCP inside IP inside Ethernet. In VPN the initial payloads are encypted in TLS and sent to the VPN gateway, that can decrypt them and route the decrypted payload inside the private network.</p>
<h3>Addres Resolution Protocol (ARP)</h3>
<p>ARP is the mechanism by which the network layer can discover the link address associated with a network address it’s directly connected to. It's the algorithm that maps IP packets address to link address for the next hop in the link for a given packet. An IP address is a network-level address. It describes a host, a unique destination at the network
layer. A link address, in contrast, describes a particular network card, a unique device.</p>
<p><img alt="Network and Link addresses" src="/assets/images/posts/ARP1.png"><br><br></p>
<p>The fact that link layer and network layer addresses are decoupled logically but coupled in practice is in some ways a historical artifact. When the Internet started, there were many link layers, and it wanted to be able to run on top of all of them. <br><br></p>
<p>ARP is a simple request-reply protocol. Every node keeps a cache of mappings from IP addresses on its network to link layer addresses. The requester can ask for a network-link address map so that every node hears the request, a node sends requests to a link layer broadcast address.
Every node in the network will hear the packet.
Furthermore, ARP is structured so that it contains redundant data. The request contains
the network and link layer address of the requestor. That way, when nodes hear a request
(since it’s broadcast), they can insert or refresh a mapping in their cache.</p>
<p><img alt="ARP packet" src="/assets/images/posts/ARP2.png"><br><br></p>
<p>If a node needs to send a packet to or through an IP address whose link layer address it does not have, it can request the address through ARP.</p></div>
            </div> -->
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/a-brainstorm-before-starting/">A Brainstorm Before Starting</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2015-07-29T15:41:43+02:00">2015-07-29 15:41</time>
</div>
                <div class="stats">
                    
                </div>
                        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/hacking/" rel="tag">Hacking</a></li>
           <li><a class="tag p-category" href="categories/testing/" rel="tag">Testing</a></li>
        </ul>
</div>

            </div>
            <!-- <div class="body">
                <body><div tabindex="-1" id="notebook" class="border-box-sizing">
    <div class="container" id="notebook-container">

<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="A-Brainstorm-before-starting">A Brainstorm before starting<a class="anchor-link" href="/posts/a-brainstorm-before-starting/#A-Brainstorm-before-starting">¶</a></h2><p>Taken from: Julien Danjou's Hacker's Guide To Python</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="kn">import</span> <span class="nn">this</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>The Zen of Python, by Tim Peters

Beautiful is better than ugly.
Explicit is better than implicit.
Simple is better than complex.
Complex is better than complicated.
Flat is better than nested.
Sparse is better than dense.
Readability counts.
Special cases aren't special enough to break the rules.
Although practicality beats purity.
Errors should never pass silently.
Unless explicitly silenced.
In the face of ambiguity, refuse the temptation to guess.
There should be one-- and preferably only one --obvious way to do it.
Although that way may not be obvious at first unless you're Dutch.
Now is better than never.
Although never is often better than *right* now.
If the implementation is hard to explain, it's a bad idea.
If the implementation is easy to explain, it may be a good idea.
Namespaces are one honking great idea -- let's do more of those!
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="kn">import</span> <span class="nn">sys</span>

<span class="n">sys</span><span class="o">.</span><span class="n">builtin_module_names</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[1]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>('_ast',
 '_bisect',
 '_codecs',
 '_codecs_cn',
 '_codecs_hk',
 '_codecs_iso2022',
 '_codecs_jp',
 '_codecs_kr',
 '_codecs_tw',
 '_collections',
 '_csv',
 '_datetime',
 '_functools',
 '_heapq',
 '_imp',
 '_io',
 '_json',
 '_locale',
 '_lsprof',
 '_md5',
 '_multibytecodec',
 '_pickle',
 '_random',
 '_sha1',
 '_sha256',
 '_sha512',
 '_sre',
 '_string',
 '_struct',
 '_symtable',
 '_thread',
 '_warnings',
 '_weakref',
 '_winapi',
 'array',
 'atexit',
 'audioop',
 'binascii',
 'builtins',
 'cmath',
 'errno',
 'faulthandler',
 'gc',
 'itertools',
 'marshal',
 'math',
 'mmap',
 'msvcrt',
 'nt',
 'operator',
 'parser',
 'signal',
 'sys',
 'time',
 'winreg',
 'xxsubtype',
 'zipimport',
 'zlib')</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="kn">from</span> <span class="nn">itertools</span> <span class="k">import</span> <span class="n">permutations</span>

<span class="nb">print</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">permutations</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>120
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>"Whenever you are about to write our own function to handle a simple task, please <strong>stop</strong> and look through the standard library first."</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>"There’s a few of the standard modules that you should definitely know about:</p>
<ul>
<li>operator: provides functions implementing the basic Python operators which you can use instead of having t owrite your own lambda expressions</li>
<li>os: provides access to basic OS functions. </li>
<li>random: provides functions for generating pseudo-random numbers. </li>
<li>re: provides regular expression functionalities.</li>
<li>functools</li>
<li>iterators</li>
<li>uuid: allows to autogenerate UUIDs(Universall Unique Identifiers)."</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Fixtures">Fixtures<a class="anchor-link" href="/posts/a-brainstorm-before-starting/#Fixtures">¶</a></h3><p>"In unit testing, <strong>fixtures</strong> represent components that are set up before a test, and cleaned up ater the test is done. It’s usually a good idea to build a special kind of component for them."</p>
<h4 id="Basics">Basics<a class="anchor-link" href="/posts/a-brainstorm-before-starting/#Basics">¶</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="c">## Unittest setUp() and tearDown(). Running code before and after unittest</span>

<span class="kn">import</span> <span class="nn">unittest</span>

<span class="k">class</span> <span class="nc">TestMe</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span> 
    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
    
    <span class="k">def</span> <span class="nf">test_length</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list</span><span class="p">),</span> <span class="mi">4</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">test_has_one</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">list</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="fixtures-module">fixtures module<a class="anchor-link" href="/posts/a-brainstorm-before-starting/#fixtures-module">¶</a></h4><p>"The fixtures module provides a few built-in fixtures, like <code>fixtures.Environment</code> Variable – useful for adding or changing a variable in <code>os.environ</code> that will be reset upon test exit."</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="kn">import</span> <span class="nn">fixtures</span> <span class="c"># not part of the standard library</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="k">class</span> <span class="nc">TestEnviron</span><span class="p">(</span><span class="n">fixtures</span><span class="o">.</span><span class="n">TestWithFixtures</span><span class="p">):</span> <span class="c"># inherits from unittest TestCase</span>
    <span class="k">def</span> <span class="nf">test_environ</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
        <span class="n">fixture</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">useFixture</span><span class="p">(</span><span class="n">fixtures</span><span class="o">.</span><span class="n">EnvironmentVariable</span><span class="p">(</span><span class="s">"FOOBAR"</span><span class="p">,</span> <span class="s">"42"</span><span class="p">))</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">"FOOBAR"</span><span class="p">),</span> <span class="s">"42"</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">test_environ_no_fixture</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">"FOOBAR"</span><span class="p">),</span> <span class="k">None</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Mocking">Mocking<a class="anchor-link" href="/posts/a-brainstorm-before-starting/#Mocking">¶</a></h3><p>"Mock objects are simulated objects that mimic the behaviour of real application objects, but in particular and controlled ways. These are especially useful in creating environments that describe precisely the conditions for which you would like to testcode"</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="kn">from</span> <span class="nn">unittest</span> <span class="k">import</span> <span class="n">mock</span> 

<span class="n">m</span> <span class="o">=</span> <span class="n">mock</span><span class="o">.</span><span class="n">Mock</span><span class="p">()</span> 
<span class="n">m</span><span class="o">.</span><span class="n">some_method</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="mi">42</span> 

<span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">some_method</span><span class="p">())</span>

<span class="k">def</span> <span class="nf">print_hello</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s">"hello world!"</span><span class="p">)</span> 
    <span class="k">return</span> <span class="mi">43</span> 

<span class="n">m</span><span class="o">.</span><span class="n">some_method</span><span class="o">.</span><span class="n">side_effect</span> <span class="o">=</span> <span class="n">print_hello</span> 

<span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">some_method</span><span class="p">())</span>

<span class="n">m</span><span class="o">.</span><span class="n">some_method</span><span class="o">.</span><span class="n">call_count</span>  <span class="c"># stats on method calling</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>42
hello world!
43
</pre>
</div>
</div>

<div class="output_area"><div class="prompt output_prompt">Out[11]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>2</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Example: Using <code>mock.patch</code> to test a set of behaviour</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="kn">import</span> <span class="nn">requests</span> 
<span class="kn">import</span> <span class="nn">unittest</span> 
<span class="kn">import</span> <span class="nn">mock</span>

<span class="k">class</span> <span class="nc">WhereIsPythonError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span> 
    <span class="k">pass</span>

<span class="k">def</span> <span class="nf">is_python_still_a_programming_language</span><span class="p">():</span> 
    <span class="k">try</span><span class="p">:</span> 
        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">"http://python.org"</span><span class="p">)</span> 
    <span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span> 
        <span class="k">pass</span> 
    <span class="k">else</span><span class="p">:</span> 
        <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span> 
            <span class="k">return</span> <span class="s">'Python is a programming language'</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">content</span> 
    <span class="k">raise</span> <span class="n">WhereIsPythonError</span><span class="p">(</span><span class="s">"Something bad happened"</span><span class="p">)</span>
        
<span class="k">def</span> <span class="nf">get_fake_get</span><span class="p">(</span><span class="n">status_code</span><span class="p">,</span> <span class="n">content</span><span class="p">):</span> 
    <span class="n">m</span> <span class="o">=</span> <span class="n">mock</span><span class="o">.</span><span class="n">Mock</span><span class="p">()</span> 
    <span class="n">m</span><span class="o">.</span><span class="n">status_code</span> <span class="o">=</span> <span class="n">status_code</span> 
    <span class="n">m</span><span class="o">.</span><span class="n">content</span> <span class="o">=</span> <span class="n">content</span> 
    <span class="k">def</span> <span class="nf">fake_get</span><span class="p">(</span><span class="n">url</span><span class="p">):</span> 
        <span class="k">return</span> <span class="n">m</span> 
    <span class="k">return</span> <span class="n">fake_get</span>

<span class="k">def</span> <span class="nf">raise_get</span><span class="p">(</span><span class="n">url</span><span class="p">):</span> 
    <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s">"Unable to fetch url %s"</span> <span class="o">%</span> <span class="n">url</span><span class="p">)</span>
    
<span class="k">class</span> <span class="nc">TestPython</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span> 
    <span class="nd">@mock</span><span class="o">.</span><span class="n">patch</span><span class="p">(</span><span class="s">'requests.get'</span><span class="p">,</span> <span class="n">get_fake_get</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="s">'Python is a programming language for sure'</span><span class="p">))</span> 
    <span class="k">def</span> <span class="nf">test_python_is</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">is_python_still_a_programming_language</span><span class="p">())</span>
        
    <span class="nd">@mock</span><span class="o">.</span><span class="n">patch</span><span class="p">(</span><span class="s">'requests.get'</span><span class="p">,</span> <span class="n">get_fake_get</span><span class="p">(</span> <span class="mi">200</span><span class="p">,</span> <span class="s">'Python is no more a programming language'</span><span class="p">))</span> 
    <span class="k">def</span> <span class="nf">test_python_is_not</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">is_python_still_a_programming_language</span><span class="p">())</span>

    <span class="nd">@mock</span><span class="o">.</span><span class="n">patch</span><span class="p">(</span><span class="s">'requests.get'</span><span class="p">,</span> <span class="n">get_fake_get</span><span class="p">(</span> <span class="mi">404</span><span class="p">,</span> <span class="s">'Whatever'</span><span class="p">))</span> 
    <span class="k">def</span> <span class="nf">test_bad_status_code</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">WhereIsPythonError</span><span class="p">,</span> <span class="n">is_python_still_a_programming_language</span><span class="p">)</span>

    <span class="nd">@mock</span><span class="o">.</span><span class="n">patch</span><span class="p">(</span><span class="s">'requests.get'</span><span class="p">,</span> <span class="n">raise_get</span><span class="p">)</span> 
    <span class="k">def</span> <span class="nf">test_ioerror</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">WhereIsPythonError</span><span class="p">,</span> <span class="n">is_python_still_a_programming_language</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Scenarios">Scenarios<a class="anchor-link" href="/posts/a-brainstorm-before-starting/#Scenarios">¶</a></h3><p>"This package provides an easy way to run a class test against a different set of scenarios generated at run-time."
Same example as in Mocking, the test runs three times because three scenarios are defined:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="kn">import</span> <span class="nn">mock</span> 
<span class="kn">import</span> <span class="nn">requests</span> 
<span class="kn">import</span> <span class="nn">testscenarios</span>

<span class="k">class</span> <span class="nc">WhereIsPythonError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span> 
    <span class="k">pass</span>

<span class="k">def</span> <span class="nf">is_python_still_a_programming_language</span><span class="p">():</span> 
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">"http://python.org"</span><span class="p">)</span> 
    <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span> 
        <span class="k">return</span> <span class="s">'Python is a programming language'</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">content</span> 
    <span class="k">raise</span> <span class="n">WhereIsPythonError</span><span class="p">(</span><span class="s">"Something bad happened"</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_fake_get</span><span class="p">(</span><span class="n">status_code</span><span class="p">,</span> <span class="n">content</span><span class="p">):</span> 
    <span class="n">m</span> <span class="o">=</span> <span class="n">mock</span><span class="o">.</span><span class="n">Mock</span><span class="p">()</span> 
    <span class="n">m</span><span class="o">.</span><span class="n">status_code</span> <span class="o">=</span> <span class="n">status_code</span>
    <span class="n">m</span><span class="o">.</span><span class="n">content</span> <span class="o">=</span> <span class="n">content</span> 
    <span class="k">def</span> <span class="nf">fake_get</span><span class="p">(</span><span class="n">url</span><span class="p">):</span> 
        <span class="k">return</span> <span class="n">m</span> 
    <span class="k">return</span> <span class="n">fake_get</span>

<span class="k">class</span> <span class="nc">TestPythonErrorCode</span><span class="p">(</span><span class="n">testscenarios</span><span class="o">.</span><span class="n">TestWithScenarios</span><span class="p">):</span> 
    <span class="n">scenarios</span> <span class="o">=</span> <span class="p">[</span> <span class="p">(</span><span class="s">'Not found'</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">404</span><span class="p">)),</span> 
                  <span class="p">(</span><span class="s">'Client error'</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">400</span><span class="p">)),</span> 
                  <span class="p">(</span><span class="s">'Server error'</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">500</span><span class="p">)),</span> <span class="p">]</span>
    
    <span class="k">def</span> <span class="nf">test_python_status_code_handling</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
        <span class="k">with</span> <span class="n">mock</span><span class="o">.</span><span class="n">patch</span><span class="p">(</span><span class="s">'requests.get'</span><span class="p">,</span> <span class="n">get_fake_get</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="s">'Python is a programming language for sure'</span><span class="p">)):</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">WhereIsPythonError</span><span class="p">,</span> <span class="n">is_python_still_a_programming_language</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Profiling">Profiling<a class="anchor-link" href="/posts/a-brainstorm-before-starting/#Profiling">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="kn">import</span> <span class="nn">cProfile</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="k">def</span> <span class="nf">print_hello</span><span class="p">():</span>
    <span class="k">def</span> <span class="nf">print_it</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s">'here'</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s">"hello world!"</span><span class="p">)</span> 
    <span class="n">print_it</span><span class="p">()</span>
    <span class="k">return</span> <span class="mi">43</span> 


<span class="n">cProfile</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s">'print_hello()'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>hello world!
here
         501 function calls (497 primitive calls) in 1.005 seconds

   Ordered by: standard name

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.005    1.005 &lt;ipython-input-7-04c863fb3a13&gt;:4(print_hello)
        1    0.000    0.000    1.004    1.004 &lt;ipython-input-7-04c863fb3a13&gt;:5(print_it)
        1    0.000    0.000    1.005    1.005 &lt;string&gt;:1(&lt;module&gt;)
        4    0.000    0.000    0.002    0.001 __init__.py:274(dumps)
        1    0.000    0.000    0.000    0.000 attrsettr.py:35(__getattr__)
        1    0.000    0.000    0.000    0.000 cp1252.py:11(encode)
        4    0.000    0.000    0.000    0.000 encoder.py:120(__init__)
        4    0.000    0.000    0.002    0.000 encoder.py:248(encode)
        4    0.000    0.000    0.000    0.000 encoder.py:277(iterencode)
        4    0.000    0.000    0.000    0.000 encoder.py:380(_make_iterencode)
       26    0.000    0.000    0.000    0.000 encoder.py:41(encode_basestring)
        1    0.000    0.000    0.000    0.000 encoder.py:51(replace)
       60    0.000    0.000    0.001    0.000 encoder.py:513(_iterencode_dict)
    64/60    0.000    0.000    0.002    0.000 encoder.py:600(_iterencode)
        1    0.000    0.000    0.000    0.000 hmac.py:114(hexdigest)
        4    0.000    0.000    0.000    0.000 hmac.py:75(update)
        1    0.000    0.000    0.000    0.000 hmac.py:82(copy)
        1    0.000    0.000    0.000    0.000 hmac.py:95(_current)
        5    0.000    0.000    0.000    0.000 iostream.py:102(_check_mp_mode)
        1    0.000    0.000    0.000    0.000 iostream.py:123(_flush_from_subprocesses)
        1    0.000    0.000    0.003    0.003 iostream.py:151(flush)
        4    0.000    0.000    0.003    0.001 iostream.py:207(write)
        1    0.000    0.000    0.000    0.000 iostream.py:238(_flush_buffer)
        1    0.000    0.000    0.000    0.000 iostream.py:247(_new_buffer)
        6    0.000    0.000    0.000    0.000 iostream.py:93(_is_master_process)
        1    0.000    0.000    0.000    0.000 iostream.py:96(_is_master_thread)
        4    0.000    0.000    0.002    0.001 jsonapi.py:31(dumps)
        1    0.000    0.000    0.000    0.000 jsonutil.py:102(date_default)
        1    0.000    0.000    0.000    0.000 poll.py:77(poll)
        1    0.000    0.000    0.000    0.000 py3compat.py:18(encode)
        1    0.000    0.000    0.000    0.000 session.py:195(msg_header)
        1    0.000    0.000    0.000    0.000 session.py:200(extract_header)
        1    0.000    0.000    0.000    0.000 session.py:441(msg_id)
        1    0.000    0.000    0.000    0.000 session.py:493(msg_header)
        1    0.000    0.000    0.000    0.000 session.py:496(msg)
        1    0.000    0.000    0.000    0.000 session.py:515(sign)
        1    0.000    0.000    0.002    0.002 session.py:530(serialize)
        1    0.000    0.000    0.003    0.003 session.py:589(send)
        1    0.000    0.000    0.000    0.000 session.py:655(&lt;listcomp&gt;)
        4    0.000    0.000    0.002    0.001 session.py:84(&lt;lambda&gt;)
        1    0.000    0.000    0.000    0.000 socket.py:289(send_multipart)
        1    0.000    0.000    0.000    0.000 threading.py:1055(ident)
        1    0.000    0.000    0.000    0.000 threading.py:1204(current_thread)
       13    0.000    0.000    0.000    0.000 traitlets.py:395(__get__)
        1    0.000    0.000    0.000    0.000 uuid.py:104(__init__)
        1    0.000    0.000    0.000    0.000 uuid.py:230(__str__)
        1    0.000    0.000    0.000    0.000 uuid.py:563(uuid4)
        1    0.000    0.000    0.000    0.000 {built-in method __new__ of type object at 0x000000001E350250}
        1    0.000    0.000    0.000    0.000 {built-in method charmap_encode}
        1    0.000    0.000    1.005    1.005 {built-in method exec}
        1    0.000    0.000    0.000    0.000 {built-in method get_ident}
        7    0.000    0.000    0.000    0.000 {built-in method getattr}
        7    0.000    0.000    0.000    0.000 {built-in method getpid}
        1    0.000    0.000    0.000    0.000 {built-in method hasattr}
        4    0.000    0.000    0.000    0.000 {built-in method id}
      135    0.000    0.000    0.000    0.000 {built-in method isinstance}
        8    0.000    0.000    0.000    0.000 {built-in method len}
        1    0.000    0.000    0.000    0.000 {built-in method locals}
        1    0.000    0.000    0.000    0.000 {built-in method max}
        1    0.000    0.000    0.000    0.000 {built-in method now}
        2    0.000    0.000    0.003    0.002 {built-in method print}
        5    1.001    0.200    1.001    0.200 {built-in method sleep}
        4    0.000    0.000    0.000    0.000 {built-in method time}
        1    0.000    0.000    0.000    0.000 {built-in method urandom}
        3    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}
        4    0.000    0.000    0.000    0.000 {method 'clear' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'close' of '_io.StringIO' objects}
        3    0.000    0.000    0.000    0.000 {method 'copy' of '_hashlib.HASH' objects}
        1    0.000    0.000    0.000    0.000 {method 'copy' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'count' of 'list' objects}
        1    0.000    0.000    0.000    0.000 {method 'digest' of '_hashlib.HASH' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        5    0.000    0.000    0.000    0.000 {method 'encode' of 'str' objects}
        2    0.000    0.000    0.000    0.000 {method 'extend' of 'list' objects}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'getvalue' of '_io.StringIO' objects}
        1    0.000    0.000    0.000    0.000 {method 'group' of '_sre.SRE_Match' objects}
        1    0.000    0.000    0.000    0.000 {method 'hexdigest' of '_hashlib.HASH' objects}
        1    0.000    0.000    0.000    0.000 {method 'isoformat' of 'datetime.datetime' objects}
        3    0.001    0.000    0.001    0.000 {method 'items' of 'dict' objects}
        4    0.000    0.000    0.000    0.000 {method 'join' of 'str' objects}
        7    0.000    0.000    0.000    0.000 {method 'send' of 'zmq.backend.cython.socket.Socket' objects}
       26    0.000    0.000    0.000    0.000 {method 'sub' of '_sre.SRE_Pattern' objects}
        5    0.000    0.000    0.000    0.000 {method 'update' of '_hashlib.HASH' objects}
        1    0.000    0.000    0.000    0.000 {method 'upper' of 'str' objects}
        4    0.000    0.000    0.000    0.000 {method 'write' of '_io.StringIO' objects}
        1    0.000    0.000    0.000    0.000 {zmq.backend.cython._poll.zmq_poll}


</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Disassemble">Disassemble<a class="anchor-link" href="/posts/a-brainstorm-before-starting/#Disassemble">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="kn">import</span> <span class="nn">dis</span>

<span class="n">dis</span><span class="o">.</span><span class="n">dis</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">y</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>  3           0 LOAD_GLOBAL              0 (sqrt) 
              3 LOAD_FAST                0 (x) 
              6 LOAD_CONST               1 (2) 
              9 BINARY_POWER         
             10 LOAD_FAST                1 (y) 
             13 LOAD_CONST               1 (2) 
             16 BINARY_POWER         
             17 BINARY_ADD           
             18 CALL_FUNCTION            1 (1 positional, 0 keyword pair) 
             21 RETURN_VALUE         
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Memory-allocation">Memory allocation<a class="anchor-link" href="/posts/a-brainstorm-before-starting/#Memory-allocation">¶</a></h3><p>A variable and its name have the same address in RAM.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">a</span> <span class="o">=</span> <span class="mi">2</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="nb">id</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>507103136
</pre>
</div>
</div>

<div class="output_area"><div class="prompt output_prompt">Out[11]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>507103136</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">a</span> <span class="o">=</span> <span class="mi">2</span>
<span class="nb">id</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="o">&gt;&gt;</span> <span class="mi">507098816</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">+</span><span class="mi">1</span>
<span class="nb">id</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">507098848</span>
<span class="nb">id</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">507098848</span>  <span class="c"># 3 and the a+1=2 have the same address</span>

<span class="n">b</span> <span class="o">=</span> <span class="mi">2</span>
<span class="nb">id</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">507098816</span>  <span class="c"># b has value 2, so it has the same address as a</span>

<span class="c">### http://www.programiz.com/python-programming/namespace</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This dynamic nature of name binding makes Python powerful.</p>

</div>
</div>
</div>
    </div>
  </div>
</body>
            </div> -->
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/norvig-on-programs-design/">Norvig On Programs Design</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2015-07-22T19:30:15+02:00">2015-07-22 19:30</time>
</div>
                <div class="stats">
                    
                </div>
                        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/software-design/" rel="tag">Software Design</a></li>
        </ul>
</div>

            </div>
            <!-- <div class="body">
                <body><div tabindex="-1" id="notebook" class="border-box-sizing">
    <div class="container" id="notebook-container">

<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Python-Programs-Design">Python Programs Design<a class="anchor-link" href="/posts/norvig-on-programs-design/#Python-Programs-Design">¶</a></h2><p>Inspired by Peter Norvig's course at Udacity<br>
 <a href="https://www.udacity.com/course/design-of-computer-programs--cs212">https://www.udacity.com/course/design-of-computer-programs--cs212</a></p>
<h3 id="Workflow">Workflow<a class="anchor-link" href="/posts/norvig-on-programs-design/#Workflow">¶</a></h3><p><strong>??</strong>   &gt;   <strong>problem</strong>      &gt;      <strong>spec</strong>      &gt;      <strong>code</strong><br>
 <em>understand</em>        <em>specify</em>             <em>design</em></p>
<p>Starting from a relative understanding of a problem/task we <em>specify</em> how things work in the domain of the problem, to <em>design</em> code that solve the problem or realize the task</p>
<h4 id="Barebone">Barebone<a class="anchor-link" href="/posts/norvig-on-programs-design/#Barebone">¶</a></h4><ol>
<li>Explain to yourself and in a team the task/problem</li>
<li>Reach a written/unformal specification of the task, defining sequential sub-tasks or complementary functions to solve the problem</li>
<li>Design your code to solve tasks and sub-tasks, minding best practices (or design patterns)</li>
<li>Code</li>
<li>Iterate with adjustments and tests</li>
</ol>
<h4 id="Code">Code<a class="anchor-link" href="/posts/norvig-on-programs-design/#Code">¶</a></h4><ol>
<li>write down a function name that realize a sub-task</li>
<li>write the docstring for the function</li>
<li>find the best built-in functions or libraries to realize the task in the function (forget optimization for now, try to be idiomatic and use the fittest tools)</li>
<li>write different functions depending on your style (functional, object oriented)</li>
<li>Accomplish the task by defining a "main" script that uses the functions</li>
</ol>
<h4 id="Example">Example<a class="anchor-link" href="/posts/norvig-on-programs-design/#Example">¶</a></h4><p>We are going to use the example of simulating a Poker game as a playground for a program design:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="k">def</span> <span class="nf">poker</span><span class="p">(</span><span class="n">hands</span><span class="p">):</span>                   <span class="c"># function name</span>
    <span class="sd">""" Return the best hand: poker([hand, ..]) =&gt; hand """</span>  <span class="c"># docstring</span>
    <span class="k">return</span> <span class="nb">max</span><span class="p">()</span>                    <span class="c"># the fittest function to return the maximum value in Python is max()</span>

<span class="nb">print</span><span class="p">(</span><span class="nb">max</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span>            <span class="c"># study from the documentation the behaviour of the function</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">max</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">key</span><span class="o">=</span><span class="nb">abs</span><span class="p">))</span>  <span class="c"># https://docs.python.org/3.3/library/functions.html#max</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>5
-5
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>A program is a set of functions, classes and operations working to solve/realize the same problem/task</strong></p>
<p>NOTE: Python3 basic built-ins <a href="https://docs.python.org/3.3/library/functions.html">https://docs.python.org/3.3/library/functions.html</a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Best-use-of-Python-design-principles">Best use of Python design principles<a class="anchor-link" href="/posts/norvig-on-programs-design/#Best-use-of-Python-design-principles">¶</a></h4><p>Going on we will get familiar with Python design principles and we will know how to use the tools the language provides. Let's see how it is possible by introducing in our design a function to define ranks for hands in a poker game.</p>
<p>NOTE: <strong>LPD</strong> stands for Leveraging Python Design, in this kind of tip I try to underline how we can design Python programs leveraging peculiar features of Python builtins or language or idioms.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="k">def</span> <span class="nf">hand_rank</span><span class="p">(</span><span class="n">hand</span><span class="p">):</span>
    <span class="sd">""" Return the rank("point") of an hand: hand =&gt; rank according to poker rules </span>
<span class="sd">    ranks = { nothing: 0, pair: 1, double pair: 2, ..., full house: 6, four of a kind: 7, ... } """</span>
    <span class="k">return</span> <span class="k">None</span> <span class="c"># by now it is not implemented, see https://youtu.be/WYHN2HfPISY if you want more details</span>

<span class="c"># How can we return the hand with the best ranking from a list of hands </span>

<span class="k">def</span> <span class="nf">poker</span><span class="p">(</span><span class="n">hands</span><span class="p">):</span>                   
    <span class="sd">""" Return the best hand: [hand, ..] =&gt; hand """</span> 
    <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">hands</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">hand_rank</span><span class="p">)</span>  <span class="c"># use of a custom function as a key for max()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>LPD</strong>: If we use the 'key' argument in max() we can find the max value coming out from the hand_rank() this is an example of how a Python function fits perfectly to solve a sub-task for our problem.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Testing">Testing<a class="anchor-link" href="/posts/norvig-on-programs-design/#Testing">¶</a></h4><p>"To be a good programmer you need to be a good tester".</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="k">def</span> <span class="nf">test</span><span class="p">():</span>
    <span class="sd">""" Test for poker() function """</span>
    <span class="n">sf</span> <span class="o">=</span> <span class="s">"6C 7C 8C 9C TC"</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>   <span class="c"># straight flush</span>
    <span class="n">fk</span> <span class="o">=</span> <span class="s">"9D 9H 9S 9C TD"</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>   <span class="c"># four of a kind</span>
    <span class="n">fh</span> <span class="o">=</span> <span class="s">"TC TD TH 9C 9h"</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>   <span class="c"># full house</span>
    <span class="k">assert</span> <span class="n">poker</span><span class="p">([</span><span class="n">sf</span><span class="p">,</span> <span class="n">fk</span><span class="p">,</span> <span class="n">fh</span><span class="p">])</span> <span class="o">==</span> <span class="n">sf</span>
    <span class="k">return</span> <span class="s">"test passed"</span>
    
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>"one of the secret of testing is to do extreme value".</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="k">def</span> <span class="nf">test</span><span class="p">():</span>
    <span class="sd">""" Test for poker() function """</span>
    <span class="n">sf</span> <span class="o">=</span> <span class="s">"6C 7C 8C 9C TC"</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>   <span class="c"># straight flush</span>
    <span class="n">fk</span> <span class="o">=</span> <span class="s">"9D 9H 9S 9C TD"</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>   <span class="c"># four of a kind</span>
    <span class="n">fh</span> <span class="o">=</span> <span class="s">"TC TD TH 9C 9h"</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>   <span class="c"># full house</span>
    <span class="k">assert</span> <span class="n">poker</span><span class="p">([</span><span class="n">sf</span><span class="p">,</span> <span class="n">fk</span><span class="p">,</span> <span class="n">fh</span><span class="p">])</span> <span class="o">==</span> <span class="n">sf</span>
    <span class="k">assert</span> <span class="n">poker</span><span class="p">([</span><span class="n">sf</span><span class="p">,</span> <span class="n">sf</span><span class="p">])</span> <span class="o">==</span> <span class="n">sf</span>        <span class="c"># extreme case, a hand challenging itself</span>
    <span class="k">assert</span> <span class="n">poker</span><span class="p">([</span><span class="n">sf</span><span class="p">]</span> <span class="o">+</span> <span class="mi">99</span><span class="o">*</span><span class="p">[</span><span class="n">fh</span><span class="p">])</span> <span class="o">==</span> <span class="n">sg</span>  <span class="c"># extreme case, a hand challenging 99 other hands</span>
    <span class="k">return</span> <span class="s">'test pass'</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is the starting design for <code>hand_rank()</code>:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="k">def</span> <span class="nf">hand_rank</span><span class="p">(</span><span class="n">hand</span><span class="p">):</span>
    <span class="sd">""" Return a tuple describing the hand, to make hands comparable.</span>
<span class="sd">    kind(), straight() and flush() are not yet implemented, they are functions that spot card ranks.</span>
<span class="sd">    card_ranks() is not yet implemented also, it turns hands in card ranks (see test()) """</span>
    <span class="n">ranks</span> <span class="o">=</span> <span class="n">card_ranks</span><span class="p">(</span><span class="n">hand</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">straight</span><span class="p">(</span><span class="n">ranks</span><span class="p">)</span> <span class="ow">and</span> <span class="n">flush</span><span class="p">(</span><span class="n">hand</span><span class="p">):</span>            <span class="c"># straight flush, (8, higher card, [card, card, card, card, card])</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">ranks</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">kind</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">ranks</span><span class="p">):</span>                           <span class="c"># 4 of a kind, (7, card, kicker)</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">kind</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">ranks</span><span class="p">),</span> <span class="n">kind</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">ranks</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">kind</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">ranks</span><span class="p">)</span> <span class="ow">and</span> <span class="n">kind</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">ranks</span><span class="p">):</span>        <span class="c"># full house, (6, higher card, lower card)</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">kind</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">ranks</span><span class="p">),</span> <span class="n">kind</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">ranks</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">flush</span><span class="p">(</span><span class="n">hand</span><span class="p">):</span>                              <span class="c"># flush, (5, higher card, [card, card, card, card, card])</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">hand</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">straight</span><span class="p">(</span><span class="n">ranks</span><span class="p">):</span>                          <span class="c"># straight, (4, higher card)</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">kind</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">ranks</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">kind</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">ranks</span><span class="p">):</span>                           <span class="c"># 3 of a kind, (3, card, kickers)</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">kind</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">ranks</span><span class="p">),</span><span class="n">kind</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">ranks</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">two_pair</span><span class="p">(</span><span class="n">ranks</span><span class="p">):</span>                          <span class="c"># 2 pair, (...)</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">kind</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">ranks</span><span class="p">),</span> <span class="n">kind</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">ranks</span><span class="p">),</span> <span class="n">kind</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">ranks</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">kind</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">ranks</span><span class="p">):</span>                           <span class="c"># kind, (...)</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">ranks</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>                                          <span class="c"># high card (...)</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ranks</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">test</span><span class="p">():</span>
    <span class="s">"Test cases for the functions in poker program"</span>
    <span class="n">sf</span> <span class="o">=</span> <span class="s">"6C 7C 8C 9C TC"</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="c"># Straight Flush</span>
    <span class="n">fk</span> <span class="o">=</span> <span class="s">"9D 9H 9S 9C 7D"</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="c"># Four of a Kind</span>
    <span class="n">fh</span> <span class="o">=</span> <span class="s">"TD TC TH 7C 7D"</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="c"># Full House</span>
    <span class="k">assert</span> <span class="n">poker</span><span class="p">([</span><span class="n">sf</span><span class="p">,</span> <span class="n">fk</span><span class="p">,</span> <span class="n">fh</span><span class="p">])</span> <span class="o">==</span> <span class="n">sf</span>
    <span class="k">assert</span> <span class="n">poker</span><span class="p">([</span><span class="n">fk</span><span class="p">,</span> <span class="n">fh</span><span class="p">])</span> <span class="o">==</span> <span class="n">fk</span>
    <span class="k">assert</span> <span class="n">poker</span><span class="p">([</span><span class="n">fh</span><span class="p">,</span> <span class="n">fh</span><span class="p">])</span> <span class="o">==</span> <span class="n">fh</span>
    <span class="k">assert</span> <span class="n">poker</span><span class="p">([</span><span class="n">sf</span><span class="p">])</span> <span class="o">==</span> <span class="n">sf</span>
    <span class="k">assert</span> <span class="n">poker</span><span class="p">([</span><span class="n">sf</span><span class="p">]</span> <span class="o">+</span> <span class="mi">99</span><span class="o">*</span><span class="p">[</span><span class="n">fh</span><span class="p">])</span> <span class="o">==</span> <span class="n">sf</span>
    <span class="k">assert</span> <span class="n">hand_rank</span><span class="p">(</span><span class="n">sf</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">hand_rank</span><span class="p">(</span><span class="n">fk</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">hand_rank</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">card_ranks</span><span class="p">(</span><span class="n">sf</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
    <span class="k">assert</span> <span class="n">card_ranks</span><span class="p">(</span><span class="n">fk</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
    <span class="k">assert</span> <span class="n">card_ranks</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
    <span class="k">return</span> <span class="s">'tests pass'</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>LPD</strong>: Tuples have been choosen as structure for describing the hands, in general <code>(rank, higher card, tie breakers)</code>. Each rank has its own definition. Ranks can be compared using Python's tuples and 'lexigraphical' operators:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="nb">print</span><span class="p">(</span><span class="s">'hello'</span> <span class="o">&lt;</span> <span class="s">'help'</span><span class="p">)</span> <span class="c"># &gt;&gt;&gt; True</span>
<span class="nb">print</span><span class="p">((</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">&gt;</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>  <span class="c"># &gt;&gt;&gt; True </span>

<span class="c"># a straight flush with 5 higher card has an higher rank compared to a straight flush with 3 higher card </span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>True
True
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>LPD</strong>: The design choice of using <code>int</code> and <code>tuples</code> to describe ranks and hands sounds good because it leverages tuples comparision and built-in features in <code>max()</code>.</p>
<h4 id="From-hands-to-card-ranks">From hands to card ranks<a class="anchor-link" href="/posts/norvig-on-programs-design/#From-hands-to-card-ranks">¶</a></h4><p>Let's see how we can add another piece to the puzzle by defining <code>card_ranks()</code>:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">mapping</span> <span class="o">=</span> <span class="p">{</span> <span class="s">'T'</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s">'J'</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="s">'Q'</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> <span class="s">'K'</span><span class="p">:</span><span class="mi">13</span><span class="p">,</span> <span class="s">'A'</span><span class="p">:</span><span class="mi">14</span> <span class="p">}</span>

<span class="k">def</span> <span class="nf">card_ranks</span><span class="p">(</span><span class="n">cards</span><span class="p">):</span>
    <span class="s">"Return a list of the ranks, sorted with higher first (maps faces to integers also, to allow easier comparision)."</span>
    <span class="n">ranks</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="k">if</span> <span class="n">r</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">mapping</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">else</span> <span class="n">mapping</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="k">for</span> <span class="n">r</span><span class="p">,</span><span class="n">s</span> <span class="ow">in</span> <span class="n">cards</span><span class="p">]</span> 
    <span class="n">ranks</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ranks</span>

<span class="nb">print</span><span class="p">(</span><span class="n">card_ranks</span><span class="p">([</span><span class="s">'AC'</span><span class="p">,</span> <span class="s">'3D'</span><span class="p">,</span> <span class="s">'4S'</span><span class="p">,</span> <span class="s">'KH'</span><span class="p">]))</span> <span class="c"># should output [14, 13, 4, 3]</span>

<span class="c"># Peter Norvig's way to define 'ranks' variable:</span>
<span class="c"># ranks = ['--23456789TJQKA'.index(r) for r,s in cards]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Spot-a-point-in-hands">Spot a point in hands<a class="anchor-link" href="/posts/norvig-on-programs-design/#Spot-a-point-in-hands">¶</a></h4><p>Let's see how we can add other functions to the design by defining the methods to spot poker rankings into a ranked hand, stuff like <code>kind()</code>, <code>straight()</code>, <code>flush()</code>, <code>two_pair()</code>. First we add something to our <code>test()</code>:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="k">def</span> <span class="nf">test</span><span class="p">():</span>
    <span class="s">"Test cases for the functions in poker program"</span>
    <span class="n">sf</span> <span class="o">=</span> <span class="s">"6C 7C 8C 9C TC"</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="c"># Straight Flush</span>
    <span class="n">fk</span> <span class="o">=</span> <span class="s">"9D 9H 9S 9C 7D"</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="c"># Four of a Kind</span>
    <span class="n">fh</span> <span class="o">=</span> <span class="s">"TD TC TH 7C 7D"</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="c"># Full House</span>
    <span class="k">assert</span> <span class="n">poker</span><span class="p">([</span><span class="n">sf</span><span class="p">,</span> <span class="n">fk</span><span class="p">,</span> <span class="n">fh</span><span class="p">])</span> <span class="o">==</span> <span class="n">sf</span>
    <span class="k">assert</span> <span class="n">poker</span><span class="p">([</span><span class="n">fk</span><span class="p">,</span> <span class="n">fh</span><span class="p">])</span> <span class="o">==</span> <span class="n">fk</span>
    <span class="k">assert</span> <span class="n">poker</span><span class="p">([</span><span class="n">fh</span><span class="p">,</span> <span class="n">fh</span><span class="p">])</span> <span class="o">==</span> <span class="n">fh</span>
    <span class="k">assert</span> <span class="n">poker</span><span class="p">([</span><span class="n">sf</span><span class="p">])</span> <span class="o">==</span> <span class="n">sf</span>
    <span class="k">assert</span> <span class="n">poker</span><span class="p">([</span><span class="n">sf</span><span class="p">]</span> <span class="o">+</span> <span class="mi">99</span><span class="o">*</span><span class="p">[</span><span class="n">fh</span><span class="p">])</span> <span class="o">==</span> <span class="n">sf</span>
    <span class="k">assert</span> <span class="n">hand_rank</span><span class="p">(</span><span class="n">sf</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">hand_rank</span><span class="p">(</span><span class="n">fk</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">hand_rank</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">card_ranks</span><span class="p">(</span><span class="n">sf</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
    <span class="k">assert</span> <span class="n">card_ranks</span><span class="p">(</span><span class="n">fk</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
    <span class="k">assert</span> <span class="n">card_ranks</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
    <span class="k">assert</span> <span class="n">straight</span><span class="p">([</span><span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span> <span class="o">==</span> <span class="k">True</span>    <span class="c"># new</span>
    <span class="k">assert</span> <span class="n">straight</span><span class="p">([</span><span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span> <span class="o">==</span> <span class="k">False</span>   <span class="c"># new</span>
    <span class="k">assert</span> <span class="n">flush</span><span class="p">(</span><span class="n">sf</span><span class="p">)</span> <span class="o">==</span> <span class="k">True</span>        <span class="c"># new</span>
    <span class="k">assert</span> <span class="n">flush</span><span class="p">(</span><span class="n">fk</span><span class="p">)</span> <span class="o">==</span> <span class="k">False</span>       <span class="c"># new</span>
    <span class="k">return</span> <span class="s">'tests pass'</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="k">def</span> <span class="nf">straight</span><span class="p">(</span><span class="n">ranks</span><span class="p">):</span>
    <span class="s">"Return True if the ordered ranks form a 5-card straight. NOTE: It takes a ranked hands as input"</span>
    <span class="c"># Your code here.</span>
    <span class="n">ranks</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">ranks</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="k">True</span><span class="p">))</span>     <span class="c"># using iterator protocol</span>
    <span class="n">value</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">ranks</span><span class="p">)</span>                           <span class="c"># store the current value of iterator </span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
        <span class="n">nxt</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">ranks</span><span class="p">)</span>                         <span class="c"># get the next element in the iteration</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">-</span> <span class="n">nxt</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>                      <span class="c"># if the difference between consecutive elements is more than 1</span>
            <span class="k">return</span> <span class="k">False</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">nxt</span>                               <span class="c"># the next become the current</span>
    <span class="k">return</span> <span class="k">True</span>

<span class="nb">print</span><span class="p">(</span><span class="n">straight</span><span class="p">([</span><span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">straight</span><span class="p">([</span><span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">]))</span>

<span class="c"># Peter Norvig's way:</span>
<span class="c"># def straight(ranks):</span>
<span class="c">#     return (max(ranks)-min(ranks) == 4) and len(set(ranks)) == 5</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>False
True
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [31]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="k">def</span> <span class="nf">flush</span><span class="p">(</span><span class="n">hand</span><span class="p">):</span>
    <span class="s">"Return True if all the cards have the same suit. NOTE: It takes an hand as input, not the ranked hands"</span>
    <span class="n">suit</span> <span class="o">=</span> <span class="n">hand</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">hand</span><span class="p">:</span>                 <span class="c"># Note the string selection directly in the for loop </span>
        <span class="k">if</span> <span class="n">h</span> <span class="o">!=</span> <span class="n">suit</span><span class="p">:</span> <span class="k">return</span> <span class="k">False</span>
    <span class="k">return</span> <span class="k">True</span>

<span class="nb">print</span><span class="p">(</span><span class="n">flush</span><span class="p">(</span><span class="s">"6C 7C 8C 9C TC"</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>        <span class="c"># new</span>

<span class="c"># Peter Norvig's way:</span>
<span class="c"># def flush(hand):</span>
<span class="c">#    suits = [s for r, s in hand]     # Note the string selection in the for loop </span>
<span class="c">#    return len(set(suits)) == 1</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>False
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [51]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="k">def</span> <span class="nf">card_ranks</span><span class="p">(</span><span class="n">cards</span><span class="p">):</span>
    <span class="s">"Return a list of the ranks, sorted with higher first (maps faces to integers also, to allow easier comparision)."</span>
    <span class="n">mapping</span> <span class="o">=</span> <span class="p">{</span> <span class="s">'T'</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s">'J'</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="s">'Q'</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> <span class="s">'K'</span><span class="p">:</span><span class="mi">13</span><span class="p">,</span> <span class="s">'A'</span><span class="p">:</span><span class="mi">14</span> <span class="p">}</span>
    <span class="n">ranks</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="k">if</span> <span class="n">r</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">mapping</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">else</span> <span class="n">mapping</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="k">for</span> <span class="n">r</span><span class="p">,</span><span class="n">s</span> <span class="ow">in</span> <span class="n">cards</span><span class="p">]</span> 
    <span class="n">ranks</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ranks</span>

<span class="k">def</span> <span class="nf">test</span><span class="p">():</span>
    <span class="s">"Test cases for spotting cards of the same kind in a hand."</span>
    <span class="n">sf</span> <span class="o">=</span> <span class="s">"6C 7C 8C 9C TC"</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="c"># Straight Flush</span>
    <span class="n">fk</span> <span class="o">=</span> <span class="s">"9D 9H 9S 9C 7D"</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="c"># Four of a Kind</span>
    <span class="n">fh</span> <span class="o">=</span> <span class="s">"TD TC TH 7C 7D"</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="c"># Full House</span>
    <span class="n">tp</span> <span class="o">=</span> <span class="s">"TD TH 5C 8H 5H"</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="n">fkranks</span> <span class="o">=</span> <span class="n">card_ranks</span><span class="p">(</span><span class="n">fk</span><span class="p">)</span>
    <span class="n">tpranks</span> <span class="o">=</span> <span class="n">card_ranks</span><span class="p">(</span><span class="n">tp</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">kind</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">fkranks</span><span class="p">)</span> <span class="o">==</span> <span class="mi">9</span>                 <span class="c"># test for 4-of-a-kind</span>
    <span class="k">assert</span> <span class="n">kind</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">fkranks</span><span class="p">)</span> <span class="o">==</span> <span class="k">None</span>              <span class="c"># test for 3-of-a-kind</span>
    <span class="k">assert</span> <span class="n">kind</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">fkranks</span><span class="p">)</span> <span class="o">==</span> <span class="k">None</span>              <span class="c"># test for 2-of-a-kind</span>
    <span class="k">assert</span> <span class="n">kind</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">fkranks</span><span class="p">)</span> <span class="o">==</span> <span class="mi">7</span>                 <span class="c"># test for higher card</span>
    <span class="k">assert</span> <span class="n">two_pair</span><span class="p">(</span><span class="n">card_ranks</span><span class="p">(</span><span class="n">tp</span><span class="p">))</span> <span class="o">==</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>   <span class="c"># test for two_pair(), to check if there is a double 2-of-a-kind</span>
    <span class="k">return</span> <span class="s">'tests pass'</span>

<span class="k">def</span> <span class="nf">kind</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">ranks</span><span class="p">):</span>
    <span class="sd">"""Return the first rank that this hand has exactly n of.</span>
<span class="sd">    Return None if there is no n-of-a-kind in the hand."""</span>
    <span class="n">setk</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">ranks</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">setk</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ranks</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="n">n</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">item</span>
    <span class="k">return</span> <span class="k">None</span>

<span class="k">def</span> <span class="nf">two_pair</span><span class="p">(</span><span class="n">ranks</span><span class="p">):</span>
    <span class="sd">"""If there are two pair, return the two ranks as a</span>
<span class="sd">    tuple: (highest, lowest); otherwise return None."""</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ranks</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">ranks</span><span class="p">)):</span> <span class="k">return</span> <span class="k">None</span>  <span class="c"># all cards are different &gt;&gt; return None</span>
    <span class="n">two_of</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">ranks</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ranks</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">r</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">two_of</span><span class="p">:</span> <span class="n">two_of</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">two_of</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="k">return</span> <span class="k">None</span>
    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">two_of</span><span class="p">)</span>

<span class="n">test</span><span class="p">()</span>

<span class="c"># Peter Norvig's way:</span>
<span class="c"># def kind(n, ranks):</span>
<span class="c">#    for r in ranks:</span>
<span class="c">#        if ranks.count(r) == n: return r</span>
<span class="c">#    return None</span>
<span class="c"># def two_pair(ranks):</span>
<span class="c">#    pair = kind(2, ranks)</span>
<span class="c">#    lowpair = kind(2, list(reversed(ranks)))</span>
<span class="c">#    if pair and lowpair != pair:</span>
<span class="c">#        retutn (pair, lowpair)</span>
<span class="c">#    else:</span>
<span class="c">#        return None</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[10, 5]
</pre>
</div>
</div>

<div class="output_area"><div class="prompt output_prompt">Out[51]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>'tests pass'</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Testing-is-never-enough">Testing is never enough<a class="anchor-link" href="/posts/norvig-on-programs-design/#Testing-is-never-enough">¶</a></h4><p>All the rankings are up and working, but we need <strong>more tests</strong> to handle edge cases and exceptions.</p>
<p>This is only Lesson 1!</p>
<ul>
<li>How would you handle a straight with Axe low (A, 2, 3, 4, 5)?</li>
<li>How would you handle ties?</li>
<li>How would you deal poker hands to simulate a game?</li>
</ul>
<p>Complete course at <a href="https://www.udacity.com/course/design-of-computer-programs--cs212">Udacity</a> for free.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="c"># https://github.com/faif/python-patterns</span>
<span class="c"># https://github.com/davidcorne/Design-Patterns-In-Python</span>
</pre></div>

</div>
</div>
</div>

</div>
    </div>
  </div>
</body>
            </div> -->
        </div>
            <nav class="postindexpager"><ul class="pager">
<li class="next">
                <a href="index-1.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
    </section><script src="assets/js/all-nocdn.js" type="text/javascript"></script><script type="text/javascript">
            $(function(){
                $('.timeago').timeago();
            });
        </script>
</body>
</html>
