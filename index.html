<!DOCTYPE html>
<html prefix="
og: http://ogp.me/ns#
article: http://ogp.me/ns/article#
" lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="A Blog About Learning Python">
<meta name="viewport" content="width=device-width">
<title>pyHummus | pyHummus</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
<link rel="canonical" href="http://mec-is.github.io/">
<link rel="icon" href="favicon.ico" sizes="16x16">
<!--[if lt IE 9]><script src="/assets/js/html5.js"></script><![endif]--><style>
    div.input_prompt {
      display: none;
    }
    </style>
</head>
<body>
    <section class="social"><ul>
<li><a href="#" title="Home"><i class="icon-home"></i></a></li>
            <li><a href="archive.html" title="Archives"><i class="icon-folder-open-alt"></i></a></li>
            <li><a href="categories/index.html" title="Tags"><i class="icon-tags"></i></a></li>
            <li><a href="https://profiles.udacity.com/u/lorenzomoriondo" title="Me At Udacity"><i class="icon-user"></i></a></li>
            <li><a href="https://twitter.com/lorenzogotuned" title="My Twitter"><i class="icon-twitter"></i></a></li>
            <li><a href="https://it.linkedin.com/in/lorenzomoriondo" title="My LinkedIn"><i class="icon-linkedin"></i></a></li>

        <li>        <footer id="footer" role="contentinfo"><p>2015 Content collected and organized by         <a href="mailto:tunedconsulting@gmail.com">lorenzogotuned</a>   Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>      This material has been collected for learning purposes only and no commercial use. All rights reserved to sources.</p>
            
        </footer>
</li>
        </ul></section><section class="page-content"><div class="content" rel="main">
    <h1 style="letter-spacing: 3px;">pyHummus: Python Learning Dip</h1>
    <div class="post">
        <p style="font-family: monospace; font-size: 90%;">This is a collection of all the interesting things I have found during my Python learning experience, collected into IPython notebooks. These are basically only annotations and code: it's up to you to read, take some partial knowledge and structure the content for your own sake. I give you here the <i>best ingredients I could find, happy cooking with Python!</i></p>
    </div>
    <div style="min-height: 30px; margin-top: 10px;">
        <a href="https://twitter.com/share" class="twitter-share-button" data-via="lorenzogotuned" data-hashtags="Python, coding">Tweet</a><script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
</div>
    <div style="min-height: 30px;">
        <script type="text/javascript" src="http://platform.linkedin.com/in.js"></script><script type="in/share" data-counter="right"></script>
</div>
        <div class="post">
            <h1 class="title"><a href="posts/networking-basics/">Networking Basics</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2015-07-29T17:35:22+02:00">2015-07-29 17:35</time>
</div>
                <div class="stats">
                    
                </div>
                        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/devops/" rel="tag">DevOps</a></li>
           <li><a class="tag p-category" href="categories/networking/" rel="tag">Networking</a></li>
        </ul>
</div>

            </div>
            <!-- <div class="body">
                <div><p>Thanks to <a href="http://online.stanford.edu/course/introduction-computer-networking">Stanford Online</a><br></p>
<h2>Networks Layers (ISO-OSI)</h2>
<p><img alt="OSI 4 layers communication" src="/assets/images/posts/ISO-flow.png"></p>
<h3>Network Layer</h3>
<p>delivers packets to computers</p>
<p><img alt="IP in OSI" src="/assets/images/posts/ISO-4.png"></p>
<h4>Internet Protocol: characteristics</h4>
<ul>
<li>IP is a <em>datagram service</em>. Datagrams are self-contained: data and header (destination address + source address). Datagrams are delivered hop-by-hop (node-to-node, router-to-router). Routers have forwarding tables for different IP addresses, they know only the next hop for the datagram in the packet.</li>
<li>IP is <em>unreliable</em>. Packets may get lost or dropped, or simply delivered out of sequence compared with the sending sequence.</li>
<li>IP guarantees the <em>best effort</em>: packets will be dropped only when necessary (recovery these errors is on Transport, or Link).</li>
<li>IP is <em>connectionless</em>. It maintains no knowledge at all of the state or sent datagrams </li>
</ul>
<h4>Internet Protocol: model and features</h4>
<ul>
<li>IP is a deliberately simple service, to work on different kinds of physical infrastructure</li>
<li>IP tries to prevent pakets looping forever (usually due to updates in forwarding tables), using the hop-count field in the datagram (TTL field).</li>
<li>IP limits packets size depending on the underlying Link (different networks have different max-size for packets, Network layers in routers fragments packets exceed max-size)</li>
<li>IP uses checksums to check the header is not being corrupted and the destination is right</li>
</ul>
<h4>IPv4 Datagram</h4>
<p><img alt="IP in OSI" src="/assets/images/posts/ipv4-datagram.png"><br></p>
<p>You can experience the different hops walked by a packed with the <em>traceroute</em> command (<code>$&gt; traceroute -w 1 www.google.com</code>)</p>
<h3>Transport Layer</h3>
<p>delivers data to applications</p>
<h4>TCP Byte Stream</h4>
<p>Client and server establish a communication using the three-way-handshake (SYN &gt; SYN/ACK &gt; ACK):
- client sends a "synchronize" (SYN)
- server responds with a "synchronize/acknowledge" (SYN/ACK)
- client responds with an "acknowledge" (ACK)</p>
<p>Everybody can interact and learn about this behaviour with software like (Wireshark)[https://www.wireshark.org/]</p>
<h3>Packets</h3>
<p>Packet switching, Layering, Encapsulation</p>
<h4>Packet Switching</h4>
<p><em>Reminder</em>: packets are self-contained, independent chunks of communication. <br>
Flow: a collection of datagrams belonging to the same end-to-end communication (e.g. a TCP connection).</p>
<p>Packet switching principle in a common router: <em>Independently, for each arriving packet, pick its outgoing link. If the link is free, send it. Else, hold the packet for later.</em>. </p>
<p>This principle has important consequences: 
- simple packet forwarding: each router has its own forwarding table, that defines the next hop to the destination defined in the packet.
- efficient sharing of links (lines between hops): many different packets from different users/connections can share the same link.
- considering that data traffic is bursty. packet switching allows to use all available link capacity and to share link capacity. This is called <em>statistical multiplexing</em>.</p></div>
            </div> -->
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/a-brainstorm-before-starting/">A Brainstorm Before Starting</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2015-07-29T15:41:43+02:00">2015-07-29 15:41</time>
</div>
                <div class="stats">
                    
                </div>
                        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/hacking/" rel="tag">Hacking</a></li>
           <li><a class="tag p-category" href="categories/testing/" rel="tag">Testing</a></li>
        </ul>
</div>

            </div>
            <!-- <div class="body">
                <body><div tabindex="-1" id="notebook" class="border-box-sizing">
    <div class="container" id="notebook-container">

<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="A-Brainstorm-before-starting">A Brainstorm before starting<a class="anchor-link" href="/posts/a-brainstorm-before-starting/#A-Brainstorm-before-starting">¶</a></h2><p>Taken from: Julien Danjou's Hacker's Guide To Python</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="kn">import</span> <span class="nn">this</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>The Zen of Python, by Tim Peters

Beautiful is better than ugly.
Explicit is better than implicit.
Simple is better than complex.
Complex is better than complicated.
Flat is better than nested.
Sparse is better than dense.
Readability counts.
Special cases aren't special enough to break the rules.
Although practicality beats purity.
Errors should never pass silently.
Unless explicitly silenced.
In the face of ambiguity, refuse the temptation to guess.
There should be one-- and preferably only one --obvious way to do it.
Although that way may not be obvious at first unless you're Dutch.
Now is better than never.
Although never is often better than *right* now.
If the implementation is hard to explain, it's a bad idea.
If the implementation is easy to explain, it may be a good idea.
Namespaces are one honking great idea -- let's do more of those!
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="kn">import</span> <span class="nn">sys</span>

<span class="n">sys</span><span class="o">.</span><span class="n">builtin_module_names</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[1]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>('_ast',
 '_bisect',
 '_codecs',
 '_codecs_cn',
 '_codecs_hk',
 '_codecs_iso2022',
 '_codecs_jp',
 '_codecs_kr',
 '_codecs_tw',
 '_collections',
 '_csv',
 '_datetime',
 '_functools',
 '_heapq',
 '_imp',
 '_io',
 '_json',
 '_locale',
 '_lsprof',
 '_md5',
 '_multibytecodec',
 '_pickle',
 '_random',
 '_sha1',
 '_sha256',
 '_sha512',
 '_sre',
 '_string',
 '_struct',
 '_symtable',
 '_thread',
 '_warnings',
 '_weakref',
 '_winapi',
 'array',
 'atexit',
 'audioop',
 'binascii',
 'builtins',
 'cmath',
 'errno',
 'faulthandler',
 'gc',
 'itertools',
 'marshal',
 'math',
 'mmap',
 'msvcrt',
 'nt',
 'operator',
 'parser',
 'signal',
 'sys',
 'time',
 'winreg',
 'xxsubtype',
 'zipimport',
 'zlib')</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="kn">from</span> <span class="nn">itertools</span> <span class="k">import</span> <span class="n">permutations</span>

<span class="nb">print</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">permutations</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>120
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>"Whenever you are about to write our own function to handle a simple task, please <strong>stop</strong> and look through the standard library first."</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>"There’s a few of the standard modules that you should definitely know about:</p>
<ul>
<li>operator: provides functions implementing the basic Python operators which you can use instead of having t owrite your own lambda expressions</li>
<li>os: provides access to basic OS functions. </li>
<li>random: provides functions for generating pseudo-random numbers. </li>
<li>re: provides regular expression functionalities.</li>
<li>functools</li>
<li>iterators</li>
<li>uuid: allows to autogenerate UUIDs(Universall Unique Identifiers)."</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Fixtures">Fixtures<a class="anchor-link" href="/posts/a-brainstorm-before-starting/#Fixtures">¶</a></h3><p>"In unit testing, <strong>fixtures</strong> represent components that are set up before a test, and cleaned up ater the test is done. It’s usually a good idea to build a special kind of component for them."</p>
<h4 id="Basics">Basics<a class="anchor-link" href="/posts/a-brainstorm-before-starting/#Basics">¶</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="c">## Unittest setUp() and tearDown(). Running code before and after unittest</span>

<span class="kn">import</span> <span class="nn">unittest</span>

<span class="k">class</span> <span class="nc">TestMe</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span> 
    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
    
    <span class="k">def</span> <span class="nf">test_length</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list</span><span class="p">),</span> <span class="mi">4</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">test_has_one</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">list</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="fixtures-module">fixtures module<a class="anchor-link" href="/posts/a-brainstorm-before-starting/#fixtures-module">¶</a></h4><p>"The fixtures module provides a few built-in fixtures, like <code>fixtures.Environment</code> Variable – useful for adding or changing a variable in <code>os.environ</code> that will be reset upon test exit."</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="kn">import</span> <span class="nn">fixtures</span> <span class="c"># not part of the standard library</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="k">class</span> <span class="nc">TestEnviron</span><span class="p">(</span><span class="n">fixtures</span><span class="o">.</span><span class="n">TestWithFixtures</span><span class="p">):</span> <span class="c"># inherits from unittest TestCase</span>
    <span class="k">def</span> <span class="nf">test_environ</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
        <span class="n">fixture</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">useFixture</span><span class="p">(</span><span class="n">fixtures</span><span class="o">.</span><span class="n">EnvironmentVariable</span><span class="p">(</span><span class="s">"FOOBAR"</span><span class="p">,</span> <span class="s">"42"</span><span class="p">))</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">"FOOBAR"</span><span class="p">),</span> <span class="s">"42"</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">test_environ_no_fixture</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">"FOOBAR"</span><span class="p">),</span> <span class="k">None</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Mocking">Mocking<a class="anchor-link" href="/posts/a-brainstorm-before-starting/#Mocking">¶</a></h3><p>"Mock objects are simulated objects that mimic the behaviour of real application objects, but in particular and controlled ways. These are especially useful in creating environments that describe precisely the conditions for which you would like to testcode"</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="kn">from</span> <span class="nn">unittest</span> <span class="k">import</span> <span class="n">mock</span> 

<span class="n">m</span> <span class="o">=</span> <span class="n">mock</span><span class="o">.</span><span class="n">Mock</span><span class="p">()</span> 
<span class="n">m</span><span class="o">.</span><span class="n">some_method</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="mi">42</span> 

<span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">some_method</span><span class="p">())</span>

<span class="k">def</span> <span class="nf">print_hello</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s">"hello world!"</span><span class="p">)</span> 
    <span class="k">return</span> <span class="mi">43</span> 

<span class="n">m</span><span class="o">.</span><span class="n">some_method</span><span class="o">.</span><span class="n">side_effect</span> <span class="o">=</span> <span class="n">print_hello</span> 

<span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">some_method</span><span class="p">())</span>

<span class="n">m</span><span class="o">.</span><span class="n">some_method</span><span class="o">.</span><span class="n">call_count</span>  <span class="c"># stats on method calling</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>42
hello world!
43
</pre>
</div>
</div>

<div class="output_area"><div class="prompt output_prompt">Out[11]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>2</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Example: Using <code>mock.patch</code> to test a set of behaviour</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="kn">import</span> <span class="nn">requests</span> 
<span class="kn">import</span> <span class="nn">unittest</span> 
<span class="kn">import</span> <span class="nn">mock</span>

<span class="k">class</span> <span class="nc">WhereIsPythonError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span> 
    <span class="k">pass</span>

<span class="k">def</span> <span class="nf">is_python_still_a_programming_language</span><span class="p">():</span> 
    <span class="k">try</span><span class="p">:</span> 
        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">"http://python.org"</span><span class="p">)</span> 
    <span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span> 
        <span class="k">pass</span> 
    <span class="k">else</span><span class="p">:</span> 
        <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span> 
            <span class="k">return</span> <span class="s">'Python is a programming language'</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">content</span> 
    <span class="k">raise</span> <span class="n">WhereIsPythonError</span><span class="p">(</span><span class="s">"Something bad happened"</span><span class="p">)</span>
        
<span class="k">def</span> <span class="nf">get_fake_get</span><span class="p">(</span><span class="n">status_code</span><span class="p">,</span> <span class="n">content</span><span class="p">):</span> 
    <span class="n">m</span> <span class="o">=</span> <span class="n">mock</span><span class="o">.</span><span class="n">Mock</span><span class="p">()</span> 
    <span class="n">m</span><span class="o">.</span><span class="n">status_code</span> <span class="o">=</span> <span class="n">status_code</span> 
    <span class="n">m</span><span class="o">.</span><span class="n">content</span> <span class="o">=</span> <span class="n">content</span> 
    <span class="k">def</span> <span class="nf">fake_get</span><span class="p">(</span><span class="n">url</span><span class="p">):</span> 
        <span class="k">return</span> <span class="n">m</span> 
    <span class="k">return</span> <span class="n">fake_get</span>

<span class="k">def</span> <span class="nf">raise_get</span><span class="p">(</span><span class="n">url</span><span class="p">):</span> 
    <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s">"Unable to fetch url %s"</span> <span class="o">%</span> <span class="n">url</span><span class="p">)</span>
    
<span class="k">class</span> <span class="nc">TestPython</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span> 
    <span class="nd">@mock</span><span class="o">.</span><span class="n">patch</span><span class="p">(</span><span class="s">'requests.get'</span><span class="p">,</span> <span class="n">get_fake_get</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="s">'Python is a programming language for sure'</span><span class="p">))</span> 
    <span class="k">def</span> <span class="nf">test_python_is</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">is_python_still_a_programming_language</span><span class="p">())</span>
        
    <span class="nd">@mock</span><span class="o">.</span><span class="n">patch</span><span class="p">(</span><span class="s">'requests.get'</span><span class="p">,</span> <span class="n">get_fake_get</span><span class="p">(</span> <span class="mi">200</span><span class="p">,</span> <span class="s">'Python is no more a programming language'</span><span class="p">))</span> 
    <span class="k">def</span> <span class="nf">test_python_is_not</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">is_python_still_a_programming_language</span><span class="p">())</span>

    <span class="nd">@mock</span><span class="o">.</span><span class="n">patch</span><span class="p">(</span><span class="s">'requests.get'</span><span class="p">,</span> <span class="n">get_fake_get</span><span class="p">(</span> <span class="mi">404</span><span class="p">,</span> <span class="s">'Whatever'</span><span class="p">))</span> 
    <span class="k">def</span> <span class="nf">test_bad_status_code</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">WhereIsPythonError</span><span class="p">,</span> <span class="n">is_python_still_a_programming_language</span><span class="p">)</span>

    <span class="nd">@mock</span><span class="o">.</span><span class="n">patch</span><span class="p">(</span><span class="s">'requests.get'</span><span class="p">,</span> <span class="n">raise_get</span><span class="p">)</span> 
    <span class="k">def</span> <span class="nf">test_ioerror</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">WhereIsPythonError</span><span class="p">,</span> <span class="n">is_python_still_a_programming_language</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Scenarios">Scenarios<a class="anchor-link" href="/posts/a-brainstorm-before-starting/#Scenarios">¶</a></h3><p>"This package provides an easy way to run a class test against a different set of scenarios generated at run-time."
Same example as in Mocking, the test runs three times because three scenarios are defined:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="kn">import</span> <span class="nn">mock</span> 
<span class="kn">import</span> <span class="nn">requests</span> 
<span class="kn">import</span> <span class="nn">testscenarios</span>

<span class="k">class</span> <span class="nc">WhereIsPythonError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span> 
    <span class="k">pass</span>

<span class="k">def</span> <span class="nf">is_python_still_a_programming_language</span><span class="p">():</span> 
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">"http://python.org"</span><span class="p">)</span> 
    <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span> 
        <span class="k">return</span> <span class="s">'Python is a programming language'</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">content</span> 
    <span class="k">raise</span> <span class="n">WhereIsPythonError</span><span class="p">(</span><span class="s">"Something bad happened"</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_fake_get</span><span class="p">(</span><span class="n">status_code</span><span class="p">,</span> <span class="n">content</span><span class="p">):</span> 
    <span class="n">m</span> <span class="o">=</span> <span class="n">mock</span><span class="o">.</span><span class="n">Mock</span><span class="p">()</span> 
    <span class="n">m</span><span class="o">.</span><span class="n">status_code</span> <span class="o">=</span> <span class="n">status_code</span>
    <span class="n">m</span><span class="o">.</span><span class="n">content</span> <span class="o">=</span> <span class="n">content</span> 
    <span class="k">def</span> <span class="nf">fake_get</span><span class="p">(</span><span class="n">url</span><span class="p">):</span> 
        <span class="k">return</span> <span class="n">m</span> 
    <span class="k">return</span> <span class="n">fake_get</span>

<span class="k">class</span> <span class="nc">TestPythonErrorCode</span><span class="p">(</span><span class="n">testscenarios</span><span class="o">.</span><span class="n">TestWithScenarios</span><span class="p">):</span> 
    <span class="n">scenarios</span> <span class="o">=</span> <span class="p">[</span> <span class="p">(</span><span class="s">'Not found'</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">404</span><span class="p">)),</span> 
                  <span class="p">(</span><span class="s">'Client error'</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">400</span><span class="p">)),</span> 
                  <span class="p">(</span><span class="s">'Server error'</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">500</span><span class="p">)),</span> <span class="p">]</span>
    
    <span class="k">def</span> <span class="nf">test_python_status_code_handling</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
        <span class="k">with</span> <span class="n">mock</span><span class="o">.</span><span class="n">patch</span><span class="p">(</span><span class="s">'requests.get'</span><span class="p">,</span> <span class="n">get_fake_get</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="s">'Python is a programming language for sure'</span><span class="p">)):</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">WhereIsPythonError</span><span class="p">,</span> <span class="n">is_python_still_a_programming_language</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Profiling">Profiling<a class="anchor-link" href="/posts/a-brainstorm-before-starting/#Profiling">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="kn">import</span> <span class="nn">cProfile</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="k">def</span> <span class="nf">print_hello</span><span class="p">():</span>
    <span class="k">def</span> <span class="nf">print_it</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s">'here'</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s">"hello world!"</span><span class="p">)</span> 
    <span class="n">print_it</span><span class="p">()</span>
    <span class="k">return</span> <span class="mi">43</span> 


<span class="n">cProfile</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s">'print_hello()'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>hello world!
here
         501 function calls (497 primitive calls) in 1.005 seconds

   Ordered by: standard name

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.005    1.005 &lt;ipython-input-7-04c863fb3a13&gt;:4(print_hello)
        1    0.000    0.000    1.004    1.004 &lt;ipython-input-7-04c863fb3a13&gt;:5(print_it)
        1    0.000    0.000    1.005    1.005 &lt;string&gt;:1(&lt;module&gt;)
        4    0.000    0.000    0.002    0.001 __init__.py:274(dumps)
        1    0.000    0.000    0.000    0.000 attrsettr.py:35(__getattr__)
        1    0.000    0.000    0.000    0.000 cp1252.py:11(encode)
        4    0.000    0.000    0.000    0.000 encoder.py:120(__init__)
        4    0.000    0.000    0.002    0.000 encoder.py:248(encode)
        4    0.000    0.000    0.000    0.000 encoder.py:277(iterencode)
        4    0.000    0.000    0.000    0.000 encoder.py:380(_make_iterencode)
       26    0.000    0.000    0.000    0.000 encoder.py:41(encode_basestring)
        1    0.000    0.000    0.000    0.000 encoder.py:51(replace)
       60    0.000    0.000    0.001    0.000 encoder.py:513(_iterencode_dict)
    64/60    0.000    0.000    0.002    0.000 encoder.py:600(_iterencode)
        1    0.000    0.000    0.000    0.000 hmac.py:114(hexdigest)
        4    0.000    0.000    0.000    0.000 hmac.py:75(update)
        1    0.000    0.000    0.000    0.000 hmac.py:82(copy)
        1    0.000    0.000    0.000    0.000 hmac.py:95(_current)
        5    0.000    0.000    0.000    0.000 iostream.py:102(_check_mp_mode)
        1    0.000    0.000    0.000    0.000 iostream.py:123(_flush_from_subprocesses)
        1    0.000    0.000    0.003    0.003 iostream.py:151(flush)
        4    0.000    0.000    0.003    0.001 iostream.py:207(write)
        1    0.000    0.000    0.000    0.000 iostream.py:238(_flush_buffer)
        1    0.000    0.000    0.000    0.000 iostream.py:247(_new_buffer)
        6    0.000    0.000    0.000    0.000 iostream.py:93(_is_master_process)
        1    0.000    0.000    0.000    0.000 iostream.py:96(_is_master_thread)
        4    0.000    0.000    0.002    0.001 jsonapi.py:31(dumps)
        1    0.000    0.000    0.000    0.000 jsonutil.py:102(date_default)
        1    0.000    0.000    0.000    0.000 poll.py:77(poll)
        1    0.000    0.000    0.000    0.000 py3compat.py:18(encode)
        1    0.000    0.000    0.000    0.000 session.py:195(msg_header)
        1    0.000    0.000    0.000    0.000 session.py:200(extract_header)
        1    0.000    0.000    0.000    0.000 session.py:441(msg_id)
        1    0.000    0.000    0.000    0.000 session.py:493(msg_header)
        1    0.000    0.000    0.000    0.000 session.py:496(msg)
        1    0.000    0.000    0.000    0.000 session.py:515(sign)
        1    0.000    0.000    0.002    0.002 session.py:530(serialize)
        1    0.000    0.000    0.003    0.003 session.py:589(send)
        1    0.000    0.000    0.000    0.000 session.py:655(&lt;listcomp&gt;)
        4    0.000    0.000    0.002    0.001 session.py:84(&lt;lambda&gt;)
        1    0.000    0.000    0.000    0.000 socket.py:289(send_multipart)
        1    0.000    0.000    0.000    0.000 threading.py:1055(ident)
        1    0.000    0.000    0.000    0.000 threading.py:1204(current_thread)
       13    0.000    0.000    0.000    0.000 traitlets.py:395(__get__)
        1    0.000    0.000    0.000    0.000 uuid.py:104(__init__)
        1    0.000    0.000    0.000    0.000 uuid.py:230(__str__)
        1    0.000    0.000    0.000    0.000 uuid.py:563(uuid4)
        1    0.000    0.000    0.000    0.000 {built-in method __new__ of type object at 0x000000001E350250}
        1    0.000    0.000    0.000    0.000 {built-in method charmap_encode}
        1    0.000    0.000    1.005    1.005 {built-in method exec}
        1    0.000    0.000    0.000    0.000 {built-in method get_ident}
        7    0.000    0.000    0.000    0.000 {built-in method getattr}
        7    0.000    0.000    0.000    0.000 {built-in method getpid}
        1    0.000    0.000    0.000    0.000 {built-in method hasattr}
        4    0.000    0.000    0.000    0.000 {built-in method id}
      135    0.000    0.000    0.000    0.000 {built-in method isinstance}
        8    0.000    0.000    0.000    0.000 {built-in method len}
        1    0.000    0.000    0.000    0.000 {built-in method locals}
        1    0.000    0.000    0.000    0.000 {built-in method max}
        1    0.000    0.000    0.000    0.000 {built-in method now}
        2    0.000    0.000    0.003    0.002 {built-in method print}
        5    1.001    0.200    1.001    0.200 {built-in method sleep}
        4    0.000    0.000    0.000    0.000 {built-in method time}
        1    0.000    0.000    0.000    0.000 {built-in method urandom}
        3    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}
        4    0.000    0.000    0.000    0.000 {method 'clear' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'close' of '_io.StringIO' objects}
        3    0.000    0.000    0.000    0.000 {method 'copy' of '_hashlib.HASH' objects}
        1    0.000    0.000    0.000    0.000 {method 'copy' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'count' of 'list' objects}
        1    0.000    0.000    0.000    0.000 {method 'digest' of '_hashlib.HASH' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        5    0.000    0.000    0.000    0.000 {method 'encode' of 'str' objects}
        2    0.000    0.000    0.000    0.000 {method 'extend' of 'list' objects}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'getvalue' of '_io.StringIO' objects}
        1    0.000    0.000    0.000    0.000 {method 'group' of '_sre.SRE_Match' objects}
        1    0.000    0.000    0.000    0.000 {method 'hexdigest' of '_hashlib.HASH' objects}
        1    0.000    0.000    0.000    0.000 {method 'isoformat' of 'datetime.datetime' objects}
        3    0.001    0.000    0.001    0.000 {method 'items' of 'dict' objects}
        4    0.000    0.000    0.000    0.000 {method 'join' of 'str' objects}
        7    0.000    0.000    0.000    0.000 {method 'send' of 'zmq.backend.cython.socket.Socket' objects}
       26    0.000    0.000    0.000    0.000 {method 'sub' of '_sre.SRE_Pattern' objects}
        5    0.000    0.000    0.000    0.000 {method 'update' of '_hashlib.HASH' objects}
        1    0.000    0.000    0.000    0.000 {method 'upper' of 'str' objects}
        4    0.000    0.000    0.000    0.000 {method 'write' of '_io.StringIO' objects}
        1    0.000    0.000    0.000    0.000 {zmq.backend.cython._poll.zmq_poll}


</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Disassemble">Disassemble<a class="anchor-link" href="/posts/a-brainstorm-before-starting/#Disassemble">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="kn">import</span> <span class="nn">dis</span>

<span class="n">dis</span><span class="o">.</span><span class="n">dis</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">y</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>  3           0 LOAD_GLOBAL              0 (sqrt) 
              3 LOAD_FAST                0 (x) 
              6 LOAD_CONST               1 (2) 
              9 BINARY_POWER         
             10 LOAD_FAST                1 (y) 
             13 LOAD_CONST               1 (2) 
             16 BINARY_POWER         
             17 BINARY_ADD           
             18 CALL_FUNCTION            1 (1 positional, 0 keyword pair) 
             21 RETURN_VALUE         
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Memory-allocation">Memory allocation<a class="anchor-link" href="/posts/a-brainstorm-before-starting/#Memory-allocation">¶</a></h3><p>A variable and its name have the same address in RAM.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">a</span> <span class="o">=</span> <span class="mi">2</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="nb">id</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>507103136
</pre>
</div>
</div>

<div class="output_area"><div class="prompt output_prompt">Out[11]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>507103136</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">a</span> <span class="o">=</span> <span class="mi">2</span>
<span class="nb">id</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="o">&gt;&gt;</span> <span class="mi">507098816</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">+</span><span class="mi">1</span>
<span class="nb">id</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">507098848</span>
<span class="nb">id</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">507098848</span>  <span class="c"># 3 and the a+1=2 have the same address</span>

<span class="n">b</span> <span class="o">=</span> <span class="mi">2</span>
<span class="nb">id</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">507098816</span>  <span class="c"># b has value 2, so it has the same address as a</span>

<span class="c">### http://www.programiz.com/python-programming/namespace</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This dynamic nature of name binding makes Python powerful.</p>

</div>
</div>
</div>
    </div>
  </div>
</body>
            </div> -->
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/norvig-on-programs-design/">Norvig On Programs Design</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2015-07-22T19:30:15+02:00">2015-07-22 19:30</time>
</div>
                <div class="stats">
                    
                </div>
                        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/software-design/" rel="tag">Software Design</a></li>
        </ul>
</div>

            </div>
            <!-- <div class="body">
                <body><div tabindex="-1" id="notebook" class="border-box-sizing">
    <div class="container" id="notebook-container">

<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Python-Programs-Design">Python Programs Design<a class="anchor-link" href="/posts/norvig-on-programs-design/#Python-Programs-Design">¶</a></h2><p>Inspired by Peter Norvig's course at Udacity<br>
 <a href="https://www.udacity.com/course/design-of-computer-programs--cs212">https://www.udacity.com/course/design-of-computer-programs--cs212</a></p>
<h3 id="Workflow">Workflow<a class="anchor-link" href="/posts/norvig-on-programs-design/#Workflow">¶</a></h3><p><strong>??</strong>   &gt;   <strong>problem</strong>      &gt;      <strong>spec</strong>      &gt;      <strong>code</strong><br>
 <em>understand</em>        <em>specify</em>             <em>design</em></p>
<p>Starting from a relative understanding of a problem/task we <em>specify</em> how things work in the domain of the problem, to <em>design</em> code that solve the problem or realize the task</p>
<h4 id="Barebone">Barebone<a class="anchor-link" href="/posts/norvig-on-programs-design/#Barebone">¶</a></h4><ol>
<li>Explain to yourself and in a team the task/problem</li>
<li>Reach a written/unformal specification of the task, defining sequential sub-tasks or complementary functions to solve the problem</li>
<li>Design your code to solve tasks and sub-tasks, minding best practices (or design patterns)</li>
<li>Code</li>
<li>Iterate with adjustments and tests</li>
</ol>
<h4 id="Code">Code<a class="anchor-link" href="/posts/norvig-on-programs-design/#Code">¶</a></h4><ol>
<li>write down a function name that realize a sub-task</li>
<li>write the docstring for the function</li>
<li>find the best built-in functions or libraries to realize the task in the function (forget optimization for now, try to be idiomatic and use the fittest tools)</li>
<li>write different functions depending on your style (functional, object oriented)</li>
<li>Accomplish the task by defining a "main" script that uses the functions</li>
</ol>
<h4 id="Example">Example<a class="anchor-link" href="/posts/norvig-on-programs-design/#Example">¶</a></h4><p>We are going to use the example of simulating a Poker game as a playground for a program design:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="k">def</span> <span class="nf">poker</span><span class="p">(</span><span class="n">hands</span><span class="p">):</span>                   <span class="c"># function name</span>
    <span class="sd">""" Return the best hand: poker([hand, ..]) =&gt; hand """</span>  <span class="c"># docstring</span>
    <span class="k">return</span> <span class="nb">max</span><span class="p">()</span>                    <span class="c"># the fittest function to return the maximum value in Python is max()</span>

<span class="nb">print</span><span class="p">(</span><span class="nb">max</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span>            <span class="c"># study from the documentation the behaviour of the function</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">max</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">key</span><span class="o">=</span><span class="nb">abs</span><span class="p">))</span>  <span class="c"># https://docs.python.org/3.3/library/functions.html#max</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>5
-5
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>A program is a set of functions, classes and operations working to solve/realize the same problem/task</strong></p>
<p>NOTE: Python3 basic built-ins <a href="https://docs.python.org/3.3/library/functions.html">https://docs.python.org/3.3/library/functions.html</a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Best-use-of-Python-design-principles">Best use of Python design principles<a class="anchor-link" href="/posts/norvig-on-programs-design/#Best-use-of-Python-design-principles">¶</a></h4><p>Going on we will get familiar with Python design principles and we will know how to use the tools the language provides. Let's see how it is possible by introducing in our design a function to define ranks for hands in a poker game.</p>
<p>NOTE: <strong>LPD</strong> stands for Leveraging Python Design, in this kind of tip I try to underline how we can design Python programs leveraging peculiar features of Python builtins or language or idioms.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="k">def</span> <span class="nf">hand_rank</span><span class="p">(</span><span class="n">hand</span><span class="p">):</span>
    <span class="sd">""" Return the rank("point") of an hand: hand =&gt; rank according to poker rules </span>
<span class="sd">    ranks = { nothing: 0, pair: 1, double pair: 2, ..., full house: 6, four of a kind: 7, ... } """</span>
    <span class="k">return</span> <span class="k">None</span> <span class="c"># by now it is not implemented, see https://youtu.be/WYHN2HfPISY if you want more details</span>

<span class="c"># How can we return the hand with the best ranking from a list of hands </span>

<span class="k">def</span> <span class="nf">poker</span><span class="p">(</span><span class="n">hands</span><span class="p">):</span>                   
    <span class="sd">""" Return the best hand: [hand, ..] =&gt; hand """</span> 
    <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">hands</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">hand_rank</span><span class="p">)</span>  <span class="c"># use of a custom function as a key for max()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>LPD</strong>: If we use the 'key' argument in max() we can find the max value coming out from the hand_rank() this is an example of how a Python function fits perfectly to solve a sub-task for our problem.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Testing">Testing<a class="anchor-link" href="/posts/norvig-on-programs-design/#Testing">¶</a></h4><p>"To be a good programmer you need to be a good tester".</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="k">def</span> <span class="nf">test</span><span class="p">():</span>
    <span class="sd">""" Test for poker() function """</span>
    <span class="n">sf</span> <span class="o">=</span> <span class="s">"6C 7C 8C 9C TC"</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>   <span class="c"># straight flush</span>
    <span class="n">fk</span> <span class="o">=</span> <span class="s">"9D 9H 9S 9C TD"</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>   <span class="c"># four of a kind</span>
    <span class="n">fh</span> <span class="o">=</span> <span class="s">"TC TD TH 9C 9h"</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>   <span class="c"># full house</span>
    <span class="k">assert</span> <span class="n">poker</span><span class="p">([</span><span class="n">sf</span><span class="p">,</span> <span class="n">fk</span><span class="p">,</span> <span class="n">fh</span><span class="p">])</span> <span class="o">==</span> <span class="n">sf</span>
    <span class="k">return</span> <span class="s">"test passed"</span>
    
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>"one of the secret of testing is to do extreme value".</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="k">def</span> <span class="nf">test</span><span class="p">():</span>
    <span class="sd">""" Test for poker() function """</span>
    <span class="n">sf</span> <span class="o">=</span> <span class="s">"6C 7C 8C 9C TC"</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>   <span class="c"># straight flush</span>
    <span class="n">fk</span> <span class="o">=</span> <span class="s">"9D 9H 9S 9C TD"</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>   <span class="c"># four of a kind</span>
    <span class="n">fh</span> <span class="o">=</span> <span class="s">"TC TD TH 9C 9h"</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>   <span class="c"># full house</span>
    <span class="k">assert</span> <span class="n">poker</span><span class="p">([</span><span class="n">sf</span><span class="p">,</span> <span class="n">fk</span><span class="p">,</span> <span class="n">fh</span><span class="p">])</span> <span class="o">==</span> <span class="n">sf</span>
    <span class="k">assert</span> <span class="n">poker</span><span class="p">([</span><span class="n">sf</span><span class="p">,</span> <span class="n">sf</span><span class="p">])</span> <span class="o">==</span> <span class="n">sf</span>        <span class="c"># extreme case, a hand challenging itself</span>
    <span class="k">assert</span> <span class="n">poker</span><span class="p">([</span><span class="n">sf</span><span class="p">]</span> <span class="o">+</span> <span class="mi">99</span><span class="o">*</span><span class="p">[</span><span class="n">fh</span><span class="p">])</span> <span class="o">==</span> <span class="n">sg</span>  <span class="c"># extreme case, a hand challenging 99 other hands</span>
    <span class="k">return</span> <span class="s">'test pass'</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is the starting design for <code>hand_rank()</code>:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="k">def</span> <span class="nf">hand_rank</span><span class="p">(</span><span class="n">hand</span><span class="p">):</span>
    <span class="sd">""" Return a tuple describing the hand, to make hands comparable.</span>
<span class="sd">    kind(), straight() and flush() are not yet implemented, they are functions that spot card ranks.</span>
<span class="sd">    card_ranks() is not yet implemented also, it turns hands in card ranks (see test()) """</span>
    <span class="n">ranks</span> <span class="o">=</span> <span class="n">card_ranks</span><span class="p">(</span><span class="n">hand</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">straight</span><span class="p">(</span><span class="n">ranks</span><span class="p">)</span> <span class="ow">and</span> <span class="n">flush</span><span class="p">(</span><span class="n">hand</span><span class="p">):</span>            <span class="c"># straight flush, (8, higher card, [card, card, card, card, card])</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">ranks</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">kind</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">ranks</span><span class="p">):</span>                           <span class="c"># 4 of a kind, (7, card, kicker)</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">kind</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">ranks</span><span class="p">),</span> <span class="n">kind</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">ranks</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">kind</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">ranks</span><span class="p">)</span> <span class="ow">and</span> <span class="n">kind</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">ranks</span><span class="p">):</span>        <span class="c"># full house, (6, higher card, lower card)</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">kind</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">ranks</span><span class="p">),</span> <span class="n">kind</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">ranks</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">flush</span><span class="p">(</span><span class="n">hand</span><span class="p">):</span>                              <span class="c"># flush, (5, higher card, [card, card, card, card, card])</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">hand</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">straight</span><span class="p">(</span><span class="n">ranks</span><span class="p">):</span>                          <span class="c"># straight, (4, higher card)</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">kind</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">ranks</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">kind</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">ranks</span><span class="p">):</span>                           <span class="c"># 3 of a kind, (3, card, kickers)</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">kind</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">ranks</span><span class="p">),</span><span class="n">kind</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">ranks</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">two_pair</span><span class="p">(</span><span class="n">ranks</span><span class="p">):</span>                          <span class="c"># 2 pair, (...)</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">kind</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">ranks</span><span class="p">),</span> <span class="n">kind</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">ranks</span><span class="p">),</span> <span class="n">kind</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">ranks</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">kind</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">ranks</span><span class="p">):</span>                           <span class="c"># kind, (...)</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">ranks</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>                                          <span class="c"># high card (...)</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ranks</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">test</span><span class="p">():</span>
    <span class="s">"Test cases for the functions in poker program"</span>
    <span class="n">sf</span> <span class="o">=</span> <span class="s">"6C 7C 8C 9C TC"</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="c"># Straight Flush</span>
    <span class="n">fk</span> <span class="o">=</span> <span class="s">"9D 9H 9S 9C 7D"</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="c"># Four of a Kind</span>
    <span class="n">fh</span> <span class="o">=</span> <span class="s">"TD TC TH 7C 7D"</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="c"># Full House</span>
    <span class="k">assert</span> <span class="n">poker</span><span class="p">([</span><span class="n">sf</span><span class="p">,</span> <span class="n">fk</span><span class="p">,</span> <span class="n">fh</span><span class="p">])</span> <span class="o">==</span> <span class="n">sf</span>
    <span class="k">assert</span> <span class="n">poker</span><span class="p">([</span><span class="n">fk</span><span class="p">,</span> <span class="n">fh</span><span class="p">])</span> <span class="o">==</span> <span class="n">fk</span>
    <span class="k">assert</span> <span class="n">poker</span><span class="p">([</span><span class="n">fh</span><span class="p">,</span> <span class="n">fh</span><span class="p">])</span> <span class="o">==</span> <span class="n">fh</span>
    <span class="k">assert</span> <span class="n">poker</span><span class="p">([</span><span class="n">sf</span><span class="p">])</span> <span class="o">==</span> <span class="n">sf</span>
    <span class="k">assert</span> <span class="n">poker</span><span class="p">([</span><span class="n">sf</span><span class="p">]</span> <span class="o">+</span> <span class="mi">99</span><span class="o">*</span><span class="p">[</span><span class="n">fh</span><span class="p">])</span> <span class="o">==</span> <span class="n">sf</span>
    <span class="k">assert</span> <span class="n">hand_rank</span><span class="p">(</span><span class="n">sf</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">hand_rank</span><span class="p">(</span><span class="n">fk</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">hand_rank</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">card_ranks</span><span class="p">(</span><span class="n">sf</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
    <span class="k">assert</span> <span class="n">card_ranks</span><span class="p">(</span><span class="n">fk</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
    <span class="k">assert</span> <span class="n">card_ranks</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
    <span class="k">return</span> <span class="s">'tests pass'</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>LPD</strong>: Tuples have been choosen as structure for describing the hands, in general <code>(rank, higher card, tie breakers)</code>. Each rank has its own definition. Ranks can be compared using Python's tuples and 'lexigraphical' operators:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="nb">print</span><span class="p">(</span><span class="s">'hello'</span> <span class="o">&lt;</span> <span class="s">'help'</span><span class="p">)</span> <span class="c"># &gt;&gt;&gt; True</span>
<span class="nb">print</span><span class="p">((</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">&gt;</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>  <span class="c"># &gt;&gt;&gt; True </span>

<span class="c"># a straight flush with 5 higher card has an higher rank compared to a straight flush with 3 higher card </span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>True
True
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>LPD</strong>: The design choice of using <code>int</code> and <code>tuples</code> to describe ranks and hands sounds good because it leverages tuples comparision and built-in features in <code>max()</code>.</p>
<h4 id="From-hands-to-card-ranks">From hands to card ranks<a class="anchor-link" href="/posts/norvig-on-programs-design/#From-hands-to-card-ranks">¶</a></h4><p>Let's see how we can add another piece to the puzzle by defining <code>card_ranks()</code>:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">mapping</span> <span class="o">=</span> <span class="p">{</span> <span class="s">'T'</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s">'J'</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="s">'Q'</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> <span class="s">'K'</span><span class="p">:</span><span class="mi">13</span><span class="p">,</span> <span class="s">'A'</span><span class="p">:</span><span class="mi">14</span> <span class="p">}</span>

<span class="k">def</span> <span class="nf">card_ranks</span><span class="p">(</span><span class="n">cards</span><span class="p">):</span>
    <span class="s">"Return a list of the ranks, sorted with higher first (maps faces to integers also, to allow easier comparision)."</span>
    <span class="n">ranks</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="k">if</span> <span class="n">r</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">mapping</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">else</span> <span class="n">mapping</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="k">for</span> <span class="n">r</span><span class="p">,</span><span class="n">s</span> <span class="ow">in</span> <span class="n">cards</span><span class="p">]</span> 
    <span class="n">ranks</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ranks</span>

<span class="nb">print</span><span class="p">(</span><span class="n">card_ranks</span><span class="p">([</span><span class="s">'AC'</span><span class="p">,</span> <span class="s">'3D'</span><span class="p">,</span> <span class="s">'4S'</span><span class="p">,</span> <span class="s">'KH'</span><span class="p">]))</span> <span class="c"># should output [14, 13, 4, 3]</span>

<span class="c"># Peter Norvig's way to define 'ranks' variable:</span>
<span class="c"># ranks = ['--23456789TJQKA'.index(r) for r,s in cards]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Spot-a-point-in-hands">Spot a point in hands<a class="anchor-link" href="/posts/norvig-on-programs-design/#Spot-a-point-in-hands">¶</a></h4><p>Let's see how we can add other functions to the design by defining the methods to spot poker rankings into a ranked hand, stuff like <code>kind()</code>, <code>straight()</code>, <code>flush()</code>, <code>two_pair()</code>. First we add something to our <code>test()</code>:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="k">def</span> <span class="nf">test</span><span class="p">():</span>
    <span class="s">"Test cases for the functions in poker program"</span>
    <span class="n">sf</span> <span class="o">=</span> <span class="s">"6C 7C 8C 9C TC"</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="c"># Straight Flush</span>
    <span class="n">fk</span> <span class="o">=</span> <span class="s">"9D 9H 9S 9C 7D"</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="c"># Four of a Kind</span>
    <span class="n">fh</span> <span class="o">=</span> <span class="s">"TD TC TH 7C 7D"</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="c"># Full House</span>
    <span class="k">assert</span> <span class="n">poker</span><span class="p">([</span><span class="n">sf</span><span class="p">,</span> <span class="n">fk</span><span class="p">,</span> <span class="n">fh</span><span class="p">])</span> <span class="o">==</span> <span class="n">sf</span>
    <span class="k">assert</span> <span class="n">poker</span><span class="p">([</span><span class="n">fk</span><span class="p">,</span> <span class="n">fh</span><span class="p">])</span> <span class="o">==</span> <span class="n">fk</span>
    <span class="k">assert</span> <span class="n">poker</span><span class="p">([</span><span class="n">fh</span><span class="p">,</span> <span class="n">fh</span><span class="p">])</span> <span class="o">==</span> <span class="n">fh</span>
    <span class="k">assert</span> <span class="n">poker</span><span class="p">([</span><span class="n">sf</span><span class="p">])</span> <span class="o">==</span> <span class="n">sf</span>
    <span class="k">assert</span> <span class="n">poker</span><span class="p">([</span><span class="n">sf</span><span class="p">]</span> <span class="o">+</span> <span class="mi">99</span><span class="o">*</span><span class="p">[</span><span class="n">fh</span><span class="p">])</span> <span class="o">==</span> <span class="n">sf</span>
    <span class="k">assert</span> <span class="n">hand_rank</span><span class="p">(</span><span class="n">sf</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">hand_rank</span><span class="p">(</span><span class="n">fk</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">hand_rank</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">card_ranks</span><span class="p">(</span><span class="n">sf</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
    <span class="k">assert</span> <span class="n">card_ranks</span><span class="p">(</span><span class="n">fk</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
    <span class="k">assert</span> <span class="n">card_ranks</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
    <span class="k">assert</span> <span class="n">straight</span><span class="p">([</span><span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span> <span class="o">==</span> <span class="k">True</span>    <span class="c"># new</span>
    <span class="k">assert</span> <span class="n">straight</span><span class="p">([</span><span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span> <span class="o">==</span> <span class="k">False</span>   <span class="c"># new</span>
    <span class="k">assert</span> <span class="n">flush</span><span class="p">(</span><span class="n">sf</span><span class="p">)</span> <span class="o">==</span> <span class="k">True</span>        <span class="c"># new</span>
    <span class="k">assert</span> <span class="n">flush</span><span class="p">(</span><span class="n">fk</span><span class="p">)</span> <span class="o">==</span> <span class="k">False</span>       <span class="c"># new</span>
    <span class="k">return</span> <span class="s">'tests pass'</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="k">def</span> <span class="nf">straight</span><span class="p">(</span><span class="n">ranks</span><span class="p">):</span>
    <span class="s">"Return True if the ordered ranks form a 5-card straight. NOTE: It takes a ranked hands as input"</span>
    <span class="c"># Your code here.</span>
    <span class="n">ranks</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">ranks</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="k">True</span><span class="p">))</span>     <span class="c"># using iterator protocol</span>
    <span class="n">value</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">ranks</span><span class="p">)</span>                           <span class="c"># store the current value of iterator </span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
        <span class="n">nxt</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">ranks</span><span class="p">)</span>                         <span class="c"># get the next element in the iteration</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">-</span> <span class="n">nxt</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>                      <span class="c"># if the difference between consecutive elements is more than 1</span>
            <span class="k">return</span> <span class="k">False</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">nxt</span>                               <span class="c"># the next become the current</span>
    <span class="k">return</span> <span class="k">True</span>

<span class="nb">print</span><span class="p">(</span><span class="n">straight</span><span class="p">([</span><span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">straight</span><span class="p">([</span><span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">]))</span>

<span class="c"># Peter Norvig's way:</span>
<span class="c"># def straight(ranks):</span>
<span class="c">#     return (max(ranks)-min(ranks) == 4) and len(set(ranks)) == 5</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>False
True
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [31]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="k">def</span> <span class="nf">flush</span><span class="p">(</span><span class="n">hand</span><span class="p">):</span>
    <span class="s">"Return True if all the cards have the same suit. NOTE: It takes an hand as input, not the ranked hands"</span>
    <span class="n">suit</span> <span class="o">=</span> <span class="n">hand</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">hand</span><span class="p">:</span>                 <span class="c"># Note the string selection directly in the for loop </span>
        <span class="k">if</span> <span class="n">h</span> <span class="o">!=</span> <span class="n">suit</span><span class="p">:</span> <span class="k">return</span> <span class="k">False</span>
    <span class="k">return</span> <span class="k">True</span>

<span class="nb">print</span><span class="p">(</span><span class="n">flush</span><span class="p">(</span><span class="s">"6C 7C 8C 9C TC"</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>        <span class="c"># new</span>

<span class="c"># Peter Norvig's way:</span>
<span class="c"># def flush(hand):</span>
<span class="c">#    suits = [s for r, s in hand]     # Note the string selection in the for loop </span>
<span class="c">#    return len(set(suits)) == 1</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>False
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [51]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="k">def</span> <span class="nf">card_ranks</span><span class="p">(</span><span class="n">cards</span><span class="p">):</span>
    <span class="s">"Return a list of the ranks, sorted with higher first (maps faces to integers also, to allow easier comparision)."</span>
    <span class="n">mapping</span> <span class="o">=</span> <span class="p">{</span> <span class="s">'T'</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s">'J'</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="s">'Q'</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> <span class="s">'K'</span><span class="p">:</span><span class="mi">13</span><span class="p">,</span> <span class="s">'A'</span><span class="p">:</span><span class="mi">14</span> <span class="p">}</span>
    <span class="n">ranks</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="k">if</span> <span class="n">r</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">mapping</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">else</span> <span class="n">mapping</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="k">for</span> <span class="n">r</span><span class="p">,</span><span class="n">s</span> <span class="ow">in</span> <span class="n">cards</span><span class="p">]</span> 
    <span class="n">ranks</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ranks</span>

<span class="k">def</span> <span class="nf">test</span><span class="p">():</span>
    <span class="s">"Test cases for spotting cards of the same kind in a hand."</span>
    <span class="n">sf</span> <span class="o">=</span> <span class="s">"6C 7C 8C 9C TC"</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="c"># Straight Flush</span>
    <span class="n">fk</span> <span class="o">=</span> <span class="s">"9D 9H 9S 9C 7D"</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="c"># Four of a Kind</span>
    <span class="n">fh</span> <span class="o">=</span> <span class="s">"TD TC TH 7C 7D"</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="c"># Full House</span>
    <span class="n">tp</span> <span class="o">=</span> <span class="s">"TD TH 5C 8H 5H"</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="n">fkranks</span> <span class="o">=</span> <span class="n">card_ranks</span><span class="p">(</span><span class="n">fk</span><span class="p">)</span>
    <span class="n">tpranks</span> <span class="o">=</span> <span class="n">card_ranks</span><span class="p">(</span><span class="n">tp</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">kind</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">fkranks</span><span class="p">)</span> <span class="o">==</span> <span class="mi">9</span>                 <span class="c"># test for 4-of-a-kind</span>
    <span class="k">assert</span> <span class="n">kind</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">fkranks</span><span class="p">)</span> <span class="o">==</span> <span class="k">None</span>              <span class="c"># test for 3-of-a-kind</span>
    <span class="k">assert</span> <span class="n">kind</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">fkranks</span><span class="p">)</span> <span class="o">==</span> <span class="k">None</span>              <span class="c"># test for 2-of-a-kind</span>
    <span class="k">assert</span> <span class="n">kind</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">fkranks</span><span class="p">)</span> <span class="o">==</span> <span class="mi">7</span>                 <span class="c"># test for higher card</span>
    <span class="k">assert</span> <span class="n">two_pair</span><span class="p">(</span><span class="n">card_ranks</span><span class="p">(</span><span class="n">tp</span><span class="p">))</span> <span class="o">==</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>   <span class="c"># test for two_pair(), to check if there is a double 2-of-a-kind</span>
    <span class="k">return</span> <span class="s">'tests pass'</span>

<span class="k">def</span> <span class="nf">kind</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">ranks</span><span class="p">):</span>
    <span class="sd">"""Return the first rank that this hand has exactly n of.</span>
<span class="sd">    Return None if there is no n-of-a-kind in the hand."""</span>
    <span class="n">setk</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">ranks</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">setk</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ranks</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="n">n</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">item</span>
    <span class="k">return</span> <span class="k">None</span>

<span class="k">def</span> <span class="nf">two_pair</span><span class="p">(</span><span class="n">ranks</span><span class="p">):</span>
    <span class="sd">"""If there are two pair, return the two ranks as a</span>
<span class="sd">    tuple: (highest, lowest); otherwise return None."""</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ranks</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">ranks</span><span class="p">)):</span> <span class="k">return</span> <span class="k">None</span>  <span class="c"># all cards are different &gt;&gt; return None</span>
    <span class="n">two_of</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">ranks</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ranks</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">r</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">two_of</span><span class="p">:</span> <span class="n">two_of</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">two_of</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="k">return</span> <span class="k">None</span>
    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">two_of</span><span class="p">)</span>

<span class="n">test</span><span class="p">()</span>

<span class="c"># Peter Norvig's way:</span>
<span class="c"># def kind(n, ranks):</span>
<span class="c">#    for r in ranks:</span>
<span class="c">#        if ranks.count(r) == n: return r</span>
<span class="c">#    return None</span>
<span class="c"># def two_pair(ranks):</span>
<span class="c">#    pair = kind(2, ranks)</span>
<span class="c">#    lowpair = kind(2, list(reversed(ranks)))</span>
<span class="c">#    if pair and lowpair != pair:</span>
<span class="c">#        retutn (pair, lowpair)</span>
<span class="c">#    else:</span>
<span class="c">#        return None</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[10, 5]
</pre>
</div>
</div>

<div class="output_area"><div class="prompt output_prompt">Out[51]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>'tests pass'</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Testing-is-never-enough">Testing is never enough<a class="anchor-link" href="/posts/norvig-on-programs-design/#Testing-is-never-enough">¶</a></h4><p>All the rankings are up and working, but we need <strong>more tests</strong> to handle edge cases and exceptions.</p>
<p>This is only Lesson 1!</p>
<ul>
<li>How would you handle a straight with Axe low (A, 2, 3, 4, 5)?</li>
<li>How would you handle ties?</li>
<li>How would you deal poker hands to simulate a game?</li>
</ul>
<p>Complete course at <a href="https://www.udacity.com/course/design-of-computer-programs--cs212">Udacity</a> for free.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="c"># https://github.com/faif/python-patterns</span>
<span class="c"># https://github.com/davidcorne/Design-Patterns-In-Python</span>
</pre></div>

</div>
</div>
</div>

</div>
    </div>
  </div>
</body>
            </div> -->
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/interlude/">Interlude</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2015-07-21T22:30:45+02:00">2015-07-21 22:30</time>
</div>
                <div class="stats">
                    
                </div>
                        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/music/" rel="tag">Music</a></li>
        </ul>
</div>

            </div>
            <!-- <div class="body">
                <div><p>Listen to some good music!</p>
<iframe width="420" height="315" src="https://www.youtube.com/embed/VKtgWx6e0hs" frameborder="0" allowfullscreen></iframe></div>
            </div> -->
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/eckel-on-decorators/">Eckel On Decorators</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2015-07-21T21:27:30+02:00">2015-07-21 21:27</time>
</div>
                <div class="stats">
                    
                </div>
                        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/decorators/" rel="tag">Decorators</a></li>
           <li><a class="tag p-category" href="categories/functional/" rel="tag">Functional</a></li>
        </ul>
</div>

            </div>
            <!-- <div class="body">
                <body><div tabindex="-1" id="notebook" class="border-box-sizing">
    <div class="container" id="notebook-container">

<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><br></p>
<h2 id="Python-Decorators-(Classes-over-Functions?)">Python Decorators (Classes over Functions?)<a class="anchor-link" href="/posts/eckel-on-decorators/#Python-Decorators-(Classes-over-Functions?)">¶</a></h2><p>Taken From Bruce Eckel's Blog. 
 All rights reserved <a href="http://bruceeckel.github.io">http://bruceeckel.github.io</a>
<br>
<br>
NOTE: the Author states that using classes as decorators instead of functions improve readability and code refactoring, and also conceptually it is a much better solution in his opinion. I think it can be a good practice, I would like to know what a functional programmer thinks about.
<br></p>
<h3 id="Starting-example">Starting example<a class="anchor-link" href="/posts/eckel-on-decorators/#Starting-example">¶</a></h3><p>"The only constraint upon the object returned by the decorator is that it can be used as a function -- which basically means it must be callable. Thus, any classes we use as decorators must implement <code>__call__</code>."
<br>
<br></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="k">class</span> <span class="nc">myDecorator</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">'''</span>
<span class="sd">    Typically, you'll capture the function object in the constructor and later use it in the __call__() method</span>
<span class="sd">    '''</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s">"inside myDecorator.__init__()"</span><span class="p">)</span>
        <span class="n">f</span><span class="p">()</span> <span class="c"># Prove that function definition has completed</span>

    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s">"inside myDecorator.__call__()"</span><span class="p">)</span>

<span class="nd">@myDecorator</span>
<span class="k">def</span> <span class="nf">aFunction</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s">"inside aFunction()"</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s">"Finished decorating aFunction()"</span><span class="p">)</span>

<span class="n">aFunction</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>inside myDecorator.__init__()
inside aFunction()
Finished decorating aFunction()
inside myDecorator.__call__()
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><br>
<br>
"When <code>aFunction()</code> is called after it has been decorated, we get completely different behavior; the <code>myDecorator.__call__()</code> method is called instead of the original code. That's because the act of decoration replaces the original function object with the result of the decoration -- in our case, the myDecorator object replaces <code>aFunction</code>."
<br>
<br></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="c"># Very basic example with Class</span>

<span class="k">class</span> <span class="nc">entryExit</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">f</span> <span class="o">=</span> <span class="n">f</span>

    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s">"Entering"</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s">"Exited"</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span>

<span class="nd">@entryExit</span>
<span class="k">def</span> <span class="nf">func1</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s">"inside func1()"</span><span class="p">)</span>

<span class="nd">@entryExit</span>
<span class="k">def</span> <span class="nf">func2</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s">"inside func2()"</span><span class="p">)</span>

<span class="n">func1</span><span class="p">()</span>
<span class="n">func2</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Entering func1
inside func1()
Exited func1
Entering func2
inside func2()
Exited func2
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="c"># Turned into a Function</span>

<span class="k">def</span> <span class="nf">entryExit</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">new_f</span><span class="p">():</span> 
        <span class="sd">""" Wrapping functio, closure """</span>
        <span class="nb">print</span><span class="p">(</span><span class="s">"Entering"</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span>
        <span class="n">f</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s">"Exited"</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">new_f</span>

<span class="nd">@entryExit</span>
<span class="k">def</span> <span class="nf">func1</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s">"inside func1()"</span><span class="p">)</span>

<span class="nd">@entryExit</span>
<span class="k">def</span> <span class="nf">func2</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s">"inside func2()"</span><span class="p">)</span>
    
<span class="n">func1</span><span class="p">()</span>
<span class="n">func2</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">func1</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span>  <span class="c"># it prints the name of the closure function (to correct this you can use @wraps from functools library)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Entering func1
inside func1()
Exited func1
Entering func2
inside func2()
Exited func2
new_f
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><br>
<br></p>
<h2 id="Decorators-with-arguments">Decorators with arguments<a class="anchor-link" href="/posts/eckel-on-decorators/#Decorators-with-arguments">¶</a></h2><p>"Without arguments the function to be decorated is passed to the constructor, and the <code>__call__()</code> method is called whenever the decorated function is invoked."
<br>
<br></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="c"># see what happens when we add arguments to the decorator:</span>

<span class="k">class</span> <span class="nc">decoratorWithArguments</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">,</span> <span class="n">arg3</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        If there are decorator arguments, the function</span>
<span class="sd">        to be decorated is not passed to the constructor!</span>
<span class="sd">        """</span>
        <span class="nb">print</span><span class="p">(</span><span class="s">"Inside __init__()"</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">arg1</span> <span class="o">=</span> <span class="n">arg1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">arg2</span> <span class="o">=</span> <span class="n">arg2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">arg3</span> <span class="o">=</span> <span class="n">arg3</span>

    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        If there are decorator arguments, __call__() is only called</span>
<span class="sd">        once, as part of the decoration process! You can only give</span>
<span class="sd">        it a single argument, which is the function object.</span>
<span class="sd">        """</span>
        <span class="nb">print</span><span class="p">(</span><span class="s">"Inside __call__()"</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">wrapped_f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span> <span class="c"># closure that takes decorators' arguments</span>
            <span class="nb">print</span><span class="p">(</span><span class="s">"Inside wrapped_f()"</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s">"Decorator arguments:"</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">arg1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">arg2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">arg3</span><span class="p">)</span>
            <span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s">"After f(*args)"</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">wrapped_f</span> <span class="c"># .__call__ returns the closure</span>

<span class="nd">@decoratorWithArguments</span><span class="p">(</span><span class="s">"hello"</span><span class="p">,</span> <span class="s">"world"</span><span class="p">,</span> <span class="mi">42</span><span class="p">)</span>  <span class="c"># arguments passed to the decorator</span>
<span class="k">def</span> <span class="nf">sayHello</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">,</span> <span class="n">a4</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s">'sayHello arguments:'</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">,</span> <span class="n">a4</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s">"After decoration"</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s">"Preparing to call sayHello()"</span><span class="p">)</span>
<span class="n">sayHello</span><span class="p">(</span><span class="s">"say"</span><span class="p">,</span> <span class="s">"hello"</span><span class="p">,</span> <span class="s">"argument"</span><span class="p">,</span> <span class="s">"list"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s">"after first sayHello() call"</span><span class="p">)</span>
<span class="n">sayHello</span><span class="p">(</span><span class="s">"a"</span><span class="p">,</span> <span class="s">"different"</span><span class="p">,</span> <span class="s">"set of"</span><span class="p">,</span> <span class="s">"arguments"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s">"after second sayHello() call"</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Inside __init__()
Inside __call__()
After decoration
Preparing to call sayHello()
Inside wrapped_f()
Decorator arguments: hello world 42
sayHello arguments: say hello argument list
After f(*args)
after first sayHello() call
Inside wrapped_f()
Decorator arguments: hello world 42
sayHello arguments: a different set of arguments
After f(*args)
after second sayHello() call
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><br>
<br>
NOTE: instead of using <code>.__call__</code> to run the decorated function, "you must it to perform the decoration -- it is nonetheless surprising the first time you see it because it's acting so much differently than the no-argument case, and you must code the decorator very differently from the no-argument case."
<br>
<br></p>

</div>
</div>
</div>
    </div>
  </div>
</body>
            </div> -->
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/functional-concepts-for-python/">Functional Concepts For Python</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2015-07-20T22:31:23+02:00">2015-07-20 22:31</time>
</div>
                <div class="stats">
                    
                </div>
                        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/comprehensions/" rel="tag">Comprehensions</a></li>
           <li><a class="tag p-category" href="categories/decorators/" rel="tag">Decorators</a></li>
           <li><a class="tag p-category" href="categories/functional/" rel="tag">Functional</a></li>
           <li><a class="tag p-category" href="categories/generators/" rel="tag">Generators</a></li>
           <li><a class="tag p-category" href="categories/multi-dispatching/" rel="tag">Multi-Dispatching</a></li>
        </ul>
</div>

            </div>
            <!-- <div class="body">
                <body><div tabindex="-1" id="notebook" class="border-box-sizing">
    <div class="container" id="notebook-container">

<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="FUNCTIONAL-CONCEPTS-FOR-PYTHON">FUNCTIONAL CONCEPTS FOR PYTHON<a class="anchor-link" href="/posts/functional-concepts-for-python/#FUNCTIONAL-CONCEPTS-FOR-PYTHON">¶</a></h2><p>Taken from:
 Functional Programming in Python by David Mertz - O'Reilly (Free book)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="ENCAPSULATION">ENCAPSULATION<a class="anchor-link" href="/posts/functional-concepts-for-python/#ENCAPSULATION">¶</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="c"># configure the data to start with </span>
<span class="n">collection</span> <span class="o">=</span> <span class="n">get_initial_state</span><span class="p">()</span> 
<span class="n">state_var</span> <span class="o">=</span> <span class="k">None</span> 
<span class="k">for</span> <span class="n">datum</span> <span class="ow">in</span> <span class="n">data_set</span><span class="p">:</span>    
    <span class="k">if</span> <span class="n">condition</span><span class="p">(</span><span class="n">state_var</span><span class="p">):</span>        
        <span class="n">state_var</span> <span class="o">=</span> <span class="n">calculate_from</span><span class="p">(</span><span class="n">datum</span><span class="p">)</span>        
        <span class="n">new</span> <span class="o">=</span> <span class="n">modify</span><span class="p">(</span><span class="n">datum</span><span class="p">,</span> <span class="n">state_var</span><span class="p">)</span>        
        <span class="n">collection</span><span class="o">.</span><span class="n">add_to</span><span class="p">(</span><span class="n">new</span><span class="p">)</span>    
    <span class="k">else</span><span class="p">:</span>        
        <span class="n">new</span> <span class="o">=</span> <span class="n">modify_differently</span><span class="p">(</span><span class="n">datum</span><span class="p">)</span>
        <span class="n">collection</span><span class="o">.</span><span class="n">add_to</span><span class="p">(</span><span class="n">new</span><span class="p">)</span>
<span class="c"># Now actually work with the data </span>
<span class="k">for</span> <span class="n">thing</span> <span class="ow">in</span> <span class="n">collection</span><span class="p">:</span>    
    <span class="n">process</span><span class="p">(</span><span class="n">thing</span><span class="p">)</span> 
    
<span class="c">#We might simply remove the “how” of the data construction from the current scope, </span>
<span class="c">#and tuck it away in a function that we can think about in isolation </span>
<span class="c">#(or not think about at all once it is sufficiently abstracted). </span>
<span class="c">#For example:</span>
<span class="c"># tuck away construction of data</span>
<span class="k">def</span> <span class="nf">make_collection</span><span class="p">(</span><span class="n">data_set</span><span class="p">):</span>    
    <span class="n">collection</span> <span class="o">=</span> <span class="n">get_initial_state</span><span class="p">()</span>    
    <span class="n">state_var</span> <span class="o">=</span> <span class="k">None</span>    
    <span class="k">for</span> <span class="n">datum</span> <span class="ow">in</span> <span class="n">data_set</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">condition</span><span class="p">(</span><span class="n">state_var</span><span class="p">):</span>
            <span class="n">state_var</span> <span class="o">=</span> <span class="n">calculate_from</span><span class="p">(</span><span class="n">datum</span><span class="p">,</span> <span class="n">state_var</span><span class="p">)</span>
            <span class="n">new</span> <span class="o">=</span> <span class="n">modify</span><span class="p">(</span><span class="n">datum</span><span class="p">,</span> <span class="n">state_var</span><span class="p">)</span>
            <span class="n">collection</span><span class="o">.</span><span class="n">add_to</span><span class="p">(</span><span class="n">new</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>            
            <span class="n">new</span> <span class="o">=</span> <span class="n">modify_differently</span><span class="p">(</span><span class="n">datum</span><span class="p">)</span>
            <span class="n">collection</span><span class="o">.</span><span class="n">add_to</span><span class="p">(</span><span class="n">new</span><span class="p">)</span>    
    <span class="k">return</span> <span class="n">collection</span> 

<span class="c"># Now actually work with the data </span>
<span class="k">for</span> <span class="n">thing</span> <span class="ow">in</span> <span class="n">make_collection</span><span class="p">(</span><span class="n">data_set</span><span class="p">):</span>    
    <span class="n">process</span><span class="p">(</span><span class="n">thing</span><span class="p">)</span> 
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="COMPREHENSIONS">COMPREHENSIONS<a class="anchor-link" href="/posts/functional-concepts-for-python/#COMPREHENSIONS">¶</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="c">#if our original code was:</span>
<span class="n">collection</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span> 
<span class="k">for</span> <span class="n">datum</span> <span class="ow">in</span> <span class="n">data_set</span><span class="p">:</span>    
    <span class="k">if</span> <span class="n">condition</span><span class="p">(</span><span class="n">datum</span><span class="p">):</span>        
        <span class="n">collection</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">datum</span><span class="p">)</span>    
    <span class="k">else</span><span class="p">:</span>        
        <span class="n">new</span> <span class="o">=</span> <span class="n">modify</span><span class="p">(</span><span class="n">datum</span><span class="p">)</span>        
        <span class="n">collection</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new</span><span class="p">)</span> 
        
<span class="c">#Somewhat more compactly we could write this as:</span>
<span class="n">collection</span> <span class="o">=</span> <span class="p">[</span><span class="n">d</span> <span class="k">if</span> <span class="n">condition</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">else</span> <span class="n">modify</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data_set</span><span class="p">]</span> 
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="GENERATORS">GENERATORS<a class="anchor-link" href="/posts/functional-concepts-for-python/#GENERATORS">¶</a></h4><p>"they are also lazy. That is to say that they are merely a description of “how to get the data” that is not realized until one explicitly asks for it, either by calling <code>.next()</code>"</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">log_lines</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">read_line</span><span class="p">(</span><span class="n">huge_log_file</span><span class="p">)</span> <span class="k">if</span> <span class="n">complex_condition</span><span class="p">(</span><span class="n">line</span><span class="p">))</span>

<span class="c"># Obviously, this generator comprehension also has imperative versions, for example:</span>
<span class="k">def</span> <span class="nf">get_log_lines</span><span class="p">(</span><span class="n">log_file</span><span class="p">):</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">read_line</span><span class="p">(</span><span class="n">log_file</span><span class="p">)</span>    
    <span class="k">while</span> <span class="k">True</span><span class="p">:</span>         <span class="c">#  the behind-the-scenes “how” of a while loop over an iteratable (generator above)</span>
        <span class="k">try</span><span class="p">:</span>            
            <span class="k">if</span> <span class="n">complex_condition</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>                
                <span class="k">yield</span> <span class="n">line</span>   
            <span class="n">line</span> <span class="o">=</span> <span class="n">read_line</span><span class="p">(</span><span class="n">log_file</span><span class="p">)</span>        
        <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>            
            <span class="k">raise</span>
            
<span class="n">log_lines</span> <span class="o">=</span> <span class="n">get_log_lines</span><span class="p">(</span><span class="n">huge_log_file</span><span class="p">)</span> 

<span class="c"># We could do this with a class that had .__next__() and .__iter__() methods. For example:</span>
<span class="k">class</span> <span class="nc">GetLogLines</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">log_file</span><span class="p">):</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">log_file</span> <span class="o">=</span> <span class="n">log_file</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">line</span> <span class="o">=</span> <span class="k">None</span>    
    <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>        
        <span class="k">return</span> <span class="bp">self</span>    
    <span class="k">def</span> <span class="nf">__next__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">line</span> <span class="ow">is</span> <span class="k">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">line</span> <span class="o">=</span> <span class="n">read_line</span><span class="p">(</span><span class="n">log_file</span><span class="p">)</span>
        <span class="k">while</span> <span class="ow">not</span> <span class="n">complex_condition</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">line</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">line</span> <span class="o">=</span> <span class="n">read_line</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_file</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">line</span>
        
<span class="n">log_lines</span> <span class="o">=</span> <span class="n">GetLogLines</span><span class="p">(</span><span class="n">huge_log_file</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="DICTS-AND-SETS">DICTS AND SETS<a class="anchor-link" href="/posts/functional-concepts-for-python/#DICTS-AND-SETS">¶</a></h4><p>"dictionaries and sets can be created “all at once” rather than by repeatedly calling <code>.update()</code> or <code>.add()</code> in a loop. For example:"</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="p">{</span><span class="n">i</span><span class="p">:</span><span class="nb">chr</span><span class="p">(</span><span class="mi">65</span><span class="o">+</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)}</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="p">{</span><span class="nb">chr</span><span class="p">(</span><span class="mi">65</span><span class="o">+</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)}</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="RECURSION">RECURSION<a class="anchor-link" href="/posts/functional-concepts-for-python/#RECURSION">¶</a></h4><p>"Python lacks an internal feature called tail call elimination that makes deep recursion computationally efficient in some languages. Let us find a trivial example where recursion is really just a kind of iteration:"</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="k">def</span> <span class="nf">running_sum</span><span class="p">(</span><span class="n">numbers</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>    
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>        
        <span class="nb">print</span><span class="p">()</span>        
        <span class="k">return</span>    
    <span class="n">total</span> <span class="o">=</span> <span class="n">numbers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">start</span>    
    <span class="nb">print</span><span class="p">(</span><span class="n">total</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s">" "</span><span class="p">)</span>    
    <span class="n">running_sum</span><span class="p">(</span><span class="n">numbers</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">total</span><span class="p">)</span>

<span class="n">running_sum</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="c"># A slightly less trivial example, factorial in recursive and iterative style:</span>
<span class="k">def</span> <span class="nf">factorialR</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>    
    <span class="s">"Recursive factorial function"</span>    
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">N</span> <span class="o">&gt;=</span> <span class="mi">1</span>    
    <span class="k">return</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">N</span> <span class="o">&lt;=</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">N</span> <span class="o">*</span> <span class="n">factorialR</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">factorialR</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="k">def</span> <span class="nf">factorialI</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>    
    <span class="s">"Iterative factorial function"</span>    
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">N</span> <span class="o">&gt;=</span> <span class="mi">1</span>    
    <span class="n">product</span> <span class="o">=</span> <span class="mi">1</span>    
    <span class="k">while</span> <span class="n">N</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>        
        <span class="n">product</span> <span class="o">*=</span> <span class="n">N</span>        
        <span class="n">N</span> <span class="o">-=</span> <span class="mi">1</span>    
    <span class="k">return</span> <span class="n">product</span>

<span class="nb">print</span><span class="p">(</span><span class="n">factorialI</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>

<span class="c"># It is not a good idea in Python—most of the time—to use recursion merely for “iteration by other means.”</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="ALTERNATIVES-TO-FOR-LOOPs-(when-it-is-a-good-idea)">ALTERNATIVES TO FOR LOOPs (when it is a good idea)<a class="anchor-link" href="/posts/functional-concepts-for-python/#ALTERNATIVES-TO-FOR-LOOPs-(when-it-is-a-good-idea)">¶</a></h3><h4 id="using-map()">using map()<a class="anchor-link" href="/posts/functional-concepts-for-python/#using-map()">¶</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="c"># If we simply call a function inside a for loop, the built-in higherorder function map() comes to our aid:</span>
<span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">it</span><span class="p">:</span>    <span class="c"># statement-based loop    </span>
    <span class="n">func</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> 
    
<span class="c"># The following code is entirely equivalent to the functional version, except there is no repeated rebinding of the variable e involved, and hence no state:</span>
<span class="nb">map</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">it</span><span class="p">)</span>   <span class="c"># map()-based "loop"</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="c">## A similar technique is available for a functional approach to sequential program flow:</span>
<span class="c"># let f1, f2, f3 (etc) be functions that perform actions </span>
<span class="c"># an execution utility function </span>
<span class="n">do_it</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="c"># map()-based action sequence </span>
<span class="nb">map</span><span class="p">(</span><span class="n">do_it</span><span class="p">,</span> <span class="p">[</span><span class="n">f1</span><span class="p">,</span> <span class="n">f2</span><span class="p">,</span> <span class="n">f3</span><span class="p">])</span> 
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="c"># We can combine the sequencing of function calls with passing arguments from iterables:</span>
<span class="n">hello</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">first</span><span class="p">,</span> <span class="n">last</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s">"Hello"</span><span class="p">,</span> <span class="n">first</span><span class="p">,</span> <span class="n">last</span><span class="p">)</span> 
<span class="n">bye</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">first</span><span class="p">,</span> <span class="n">last</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s">"Bye"</span><span class="p">,</span> <span class="n">first</span><span class="p">,</span> <span class="n">last</span><span class="p">)</span> 
<span class="n">_</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">do_it</span><span class="p">,</span> <span class="p">[</span><span class="n">hello</span><span class="p">,</span> <span class="n">bye</span><span class="p">],</span> <span class="p">[</span><span class="s">'David'</span><span class="p">,</span><span class="s">'Jane'</span><span class="p">],</span> <span class="p">[</span><span class="s">'Mertz'</span><span class="p">,</span><span class="s">'Doe'</span><span class="p">]))</span> 

<span class="n">do_all_funcs</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">fns</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">))</span> <span class="k">for</span> <span class="n">fn</span> <span class="ow">in</span> <span class="n">fns</span><span class="p">]</span> 
<span class="n">_</span> <span class="o">=</span> <span class="n">do_all_funcs</span><span class="p">([</span><span class="n">hello</span><span class="p">,</span> <span class="n">bye</span><span class="p">],</span> <span class="p">[</span><span class="s">'David'</span><span class="p">,</span><span class="s">'Jane'</span><span class="p">],</span> <span class="p">[</span><span class="s">'Mertz'</span><span class="p">,</span><span class="s">'Doe'</span><span class="p">])</span> 
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="CALLABLES">CALLABLES<a class="anchor-link" href="/posts/functional-concepts-for-python/#CALLABLES">¶</a></h4><p>"Python actually gives us several different ways to create functions, or at least something very function-like (i.e., that can be called). They are:</p>
<ol>
<li>Regular functions created with <code>def</code> and given a name at definition time </li>
<li>Anonymous functions created with <code>lambda</code> </li>
<li>Instances of classes that define a <code>__call()__</code> method </li>
<li>Closures returned by function factories </li>
<li>Static methods of instances, either via the @staticmethod decorator or via the class <code>__dict__</code> </li>
<li>Generator functions" </li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="Lambdas-and-named-functions">Lambdas and named functions<a class="anchor-link" href="/posts/functional-concepts-for-python/#Lambdas-and-named-functions">¶</a></h5>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="k">def</span> <span class="nf">hello1</span><span class="p">(</span><span class="n">name</span><span class="p">):</span> 
    <span class="nb">print</span><span class="p">(</span><span class="s">"Hello"</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span> 
    
<span class="n">hello2</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">name</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s">"Hello"</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span> 

<span class="n">hello1</span><span class="p">(</span><span class="s">'David'</span><span class="p">)</span>
<span class="n">hello2</span><span class="p">(</span><span class="s">'David'</span><span class="p">)</span>
<span class="c"># The only real difference is in .__qualname__ attribute</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="CLOSURES-and-CLASSES">CLOSURES and CLASSES<a class="anchor-link" href="/posts/functional-concepts-for-python/#CLOSURES-and-CLASSES">¶</a></h5>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="c"># Let us construct a toy example that shows this, something just past a “hello world” of the different styles:</span>
<span class="c"># A class that creates callable adder instances </span>

<span class="k">class</span> <span class="nc">Adder</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="n">n</span>    
    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>        
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">+</span> <span class="n">m</span> 

<span class="n">add5_i</span> <span class="o">=</span> <span class="n">Adder</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>       
<span class="c"># "instance" or "imperative" We have constructed something callable that adds five to an argument passed in. Seems simple and mathematical enough. Let us also try it as a closure</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="k">def</span> <span class="nf">make_adder</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>    
    <span class="k">def</span> <span class="nf">adder</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>        
        <span class="k">return</span> <span class="n">m</span> <span class="o">+</span> <span class="n">n</span>    
    <span class="k">return</span> <span class="n">adder</span> 

<span class="n">add5_f</span> <span class="o">=</span> <span class="n">make_adder</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>  
<span class="c"># "functional" So far these seem to amount to pretty much the same thing, but the mutable state in the instance provides a attractive nuisance:</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">add5_i</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> 
<span class="n">add5_f</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>          <span class="c"># only argument affects result 15 </span>
<span class="n">add5_i</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="mi">10</span>       <span class="c"># state is readily changeable </span>
<span class="n">add5_i</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>          <span class="c"># result is dependent on prior flow 20 </span>

<span class="c"># once the object exists, the closure behaves in a pure functional way, while the class instance remains </span>
<span class="c"># state dependent</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="METHODS-OF-CLASSES">METHODS OF CLASSES<a class="anchor-link" href="/posts/functional-concepts-for-python/#METHODS-OF-CLASSES">¶</a></h5>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="c"># accessors are callables with a limited use (from a functional programming perspective) in that they take no </span>
<span class="c"># arguments as getters, and return no value as setters:</span>
<span class="k">class</span> <span class="nc">Car</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">_speed</span> <span class="o">=</span> <span class="mi">100</span>
    <span class="nd">@property</span>    
    <span class="k">def</span> <span class="nf">speed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>        
        <span class="nb">print</span><span class="p">(</span><span class="s">"Speed is"</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_speed</span><span class="p">)</span>        
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_speed</span>
    <span class="nd">@speed</span><span class="o">.</span><span class="n">setter</span>    
    <span class="k">def</span> <span class="nf">speed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>        
        <span class="nb">print</span><span class="p">(</span><span class="s">"Setting to"</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">_speed</span> <span class="o">=</span> <span class="n">value</span>

<span class="c"># &gt;&gt; car = Car()  </span>
<span class="c"># &gt;&gt;&gt; car.speed = 80  # Odd syntax to pass one argument </span>
<span class="c"># Setting to 80 </span>
<span class="c"># &gt;&gt;&gt; x = car.speed </span>
<span class="c"># x is 80</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="STATIC-METHODS">STATIC METHODS<a class="anchor-link" href="/posts/functional-concepts-for-python/#STATIC-METHODS">¶</a></h5>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="c"># One use of classes and their methods that is more closely aligned with a functional style of programming is to use </span>
<span class="c"># them simply as namespaces to hold a variety of related functions:</span>

<span class="kn">import</span> <span class="nn">math</span> 
<span class="k">class</span> <span class="nc">RightTriangle</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>    
    <span class="s">"Class used solely as namespace for related functions"</span>    
    <span class="nd">@staticmethod</span>    
    <span class="k">def</span> <span class="nf">hypotenuse</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>        
        <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="nd">@staticmethod</span>    
    <span class="k">def</span> <span class="nf">sin</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>        
        <span class="k">return</span> <span class="n">a</span> <span class="o">/</span> <span class="n">RightTriangle</span><span class="o">.</span><span class="n">hypotenuse</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
    <span class="nd">@staticmethod</span>    
    <span class="k">def</span> <span class="nf">cos</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>        
        <span class="k">return</span> <span class="n">b</span> <span class="o">/</span> <span class="n">RightTriangle</span><span class="o">.</span><span class="n">hypotenuse</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="GENERATOR-FUNCTIONS">GENERATOR FUNCTIONS<a class="anchor-link" href="/posts/functional-concepts-for-python/#GENERATOR-FUNCTIONS">¶</a></h5>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="c"># A special sort of function in Python is one that contains a yield statement, which turns it into a generator. </span>
<span class="c"># What is returned from calling such a function is not a regular value, but rather an iterator that produces a </span>
<span class="c"># sequence of values as you call the next() function on it or loop over it.</span>

<span class="k">def</span> <span class="nf">get_primes</span><span class="p">():</span> 
    <span class="s">"Simple lazy Sieve of Eratosthenes"</span> 
    <span class="n">candidate</span> <span class="o">=</span> <span class="mi">2</span> 
    <span class="n">found</span> <span class="o">=</span> <span class="p">[]</span> 
    <span class="k">while</span> <span class="k">True</span><span class="p">:</span> 
        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">candidate</span> <span class="o">%</span> <span class="n">prime</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">prime</span> <span class="ow">in</span> <span class="n">found</span><span class="p">):</span> 
            <span class="k">yield</span> <span class="n">candidate</span> 
            <span class="n">found</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">candidate</span><span class="p">)</span> 
        <span class="n">candidate</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="n">primes</span> <span class="o">=</span> <span class="n">get_primes</span><span class="p">()</span> 
<span class="nb">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">primes</span><span class="p">),</span> <span class="nb">next</span><span class="p">(</span><span class="n">primes</span><span class="p">),</span> <span class="nb">next</span><span class="p">(</span><span class="n">primes</span><span class="p">))</span>
<span class="c"># (2, 3, 5) </span>
<span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">prime</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">primes</span><span class="p">):</span> 
    <span class="nb">print</span><span class="p">(</span><span class="n">prime</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s">" "</span><span class="p">)</span> 
<span class="c">#    7 11 13 17 19 23 29 31 37 41 </span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>2 3 5
7 11 13 17 19 23 29 31 37 41 </pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="MULTIPLE-DISPATCHING">MULTIPLE DISPATCHING<a class="anchor-link" href="/posts/functional-concepts-for-python/#MULTIPLE-DISPATCHING">¶</a></h3><p>"A very interesting approach to programming multiple paths of execution is a technique called “multiple dispatch” or sometimes 'multimethods'. The idea here is to declare multiple signatures for a single function and call the actual computation that matches the types or properties of the calling arguments." 
Note: used to avoid many if-else statements to test matchings</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="kn">from</span> <span class="nn">multipledispatch</span> <span class="k">import</span> <span class="n">dispatch</span>

<span class="k">class</span> <span class="nc">Thing</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span> <span class="k">pass</span> 
<span class="k">class</span> <span class="nc">Rock</span><span class="p">(</span><span class="n">Thing</span><span class="p">):</span> <span class="k">pass</span>
<span class="k">class</span> <span class="nc">Paper</span><span class="p">(</span><span class="n">Thing</span><span class="p">):</span> <span class="k">pass</span> 
<span class="k">class</span> <span class="nc">Scissors</span><span class="p">(</span><span class="n">Thing</span><span class="p">):</span> <span class="k">pass</span>

<span class="nd">@dispatch</span><span class="p">(</span><span class="n">Rock</span><span class="p">,</span> <span class="n">Rock</span><span class="p">)</span> 
<span class="k">def</span> <span class="nf">beats3</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span> 
    <span class="k">return</span> <span class="k">None</span>

<span class="nd">@dispatch</span><span class="p">(</span><span class="n">Rock</span><span class="p">,</span> <span class="n">Paper</span><span class="p">)</span> 
<span class="k">def</span> <span class="nf">beats3</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span> 
    <span class="k">return</span> <span class="n">y</span>

<span class="nd">@dispatch</span><span class="p">(</span><span class="n">Rock</span><span class="p">,</span> <span class="n">Scissors</span><span class="p">)</span> 
<span class="k">def</span> <span class="nf">beats3</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span> 
    <span class="k">return</span> <span class="n">x</span>

<span class="nd">@dispatch</span><span class="p">(</span><span class="n">Paper</span><span class="p">,</span> <span class="n">Rock</span><span class="p">)</span> 
<span class="k">def</span> <span class="nf">beats3</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span> 
    <span class="k">return</span> <span class="n">x</span>

<span class="nd">@dispatch</span><span class="p">(</span><span class="n">Paper</span><span class="p">,</span> <span class="n">Paper</span><span class="p">)</span> 
<span class="k">def</span> <span class="nf">beats3</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span> 
    <span class="k">return</span> <span class="k">None</span>

<span class="nd">@dispatch</span><span class="p">(</span><span class="n">Paper</span><span class="p">,</span> <span class="n">Scissors</span><span class="p">)</span> 
<span class="k">def</span> <span class="nf">beats3</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span> 
    <span class="k">return</span> <span class="n">x</span>

<span class="nd">@dispatch</span><span class="p">(</span><span class="n">Scissors</span><span class="p">,</span> <span class="n">Rock</span><span class="p">)</span> 
<span class="k">def</span> <span class="nf">beats3</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span> 
    <span class="k">return</span> <span class="n">y</span>

<span class="nd">@dispatch</span><span class="p">(</span><span class="n">Scissors</span><span class="p">,</span> <span class="n">Paper</span><span class="p">)</span> 
<span class="k">def</span> <span class="nf">beats3</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span> 
    <span class="k">return</span> <span class="n">x</span>

<span class="nd">@dispatch</span><span class="p">(</span><span class="n">Scissors</span><span class="p">,</span> <span class="n">Scissors</span><span class="p">)</span> 
<span class="k">def</span> <span class="nf">beats3</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span> 
    <span class="k">return</span> <span class="k">None</span>

<span class="nd">@dispatch</span><span class="p">(</span><span class="nb">object</span><span class="p">,</span> <span class="nb">object</span><span class="p">)</span> 
<span class="k">def</span> <span class="nf">beats3</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>    
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">Rock</span><span class="p">,</span> <span class="n">Paper</span><span class="p">,</span> <span class="n">Scissors</span><span class="p">)):</span>        
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">"Unknown first thing"</span><span class="p">)</span>    
    <span class="k">else</span><span class="p">:</span>        
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">"Unknown second thing"</span><span class="p">)</span>

<span class="n">rock</span><span class="p">,</span> <span class="n">paper</span> <span class="o">=</span> <span class="n">Rock</span><span class="p">(),</span> <span class="n">Paper</span><span class="p">()</span>        
<span class="nb">print</span><span class="p">(</span><span class="n">beats3</span><span class="p">(</span><span class="n">rock</span><span class="p">,</span> <span class="n">paper</span><span class="p">))</span>
<span class="c"># &lt;__main__.DuckPaper at 0x103b894a8&gt; </span>
<span class="c"># &gt;&gt;&gt; beats3(rock, 3) </span>
<span class="c"># TypeError: Unknown second thing</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;__main__.Paper object at 0x0000000003944C18&gt;
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="LAZY-EVALUATION">LAZY EVALUATION<a class="anchor-link" href="/posts/functional-concepts-for-python/#LAZY-EVALUATION">¶</a></h3><h4 id='Custom-sequence-using-"abc"'>Custom sequence using "abc"<a class="anchor-link" href="/posts/functional-concepts-for-python/#Custom-sequence-using-%22abc%22">¶</a></h4><p>"Given the get_primes() generator function discussed earlier, we might write our own container to simulate the same thing, for example:"</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="kn">from</span> <span class="nn">collections.abc</span> <span class="k">import</span> <span class="n">Sequence</span> 
<span class="k">class</span> <span class="nc">ExpandingSequence</span><span class="p">(</span><span class="n">Sequence</span><span class="p">):</span>    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">it</span><span class="p">):</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">it</span> <span class="o">=</span> <span class="n">it</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span> <span class="o">=</span> <span class="p">[]</span>    
    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>        
        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">index</span><span class="p">:</span>            
            <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">it</span><span class="p">))</span>        
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>    
    <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>        
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span> 

<span class="c"># This new container can be both lazy and also indexible:</span>
<span class="n">primes</span> <span class="o">=</span> <span class="n">ExpandingSequence</span><span class="p">(</span><span class="n">get_primes</span><span class="p">())</span>
<span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">primes</span><span class="p">):</span>     
    <span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s">" "</span><span class="p">)</span> 
<span class="c"># 2 3 5 7 11 13 17 19 23 29 </span>
<span class="n">primes</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span>  <span class="c"># 31 </span>
<span class="n">primes</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>   <span class="c"># 13 </span>
<span class="nb">len</span><span class="p">(</span><span class="n">primes</span><span class="p">)</span> <span class="c"># 11 </span>
<span class="n">primes</span><span class="p">[</span><span class="mi">100</span><span class="p">]</span> <span class="c"># 547 </span>
<span class="nb">len</span><span class="p">(</span><span class="n">primes</span><span class="p">)</span> <span class="c"># 101</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Custom-iterator">Custom iterator<a class="anchor-link" href="/posts/functional-concepts-for-python/#Custom-iterator">¶</a></h4><p>"...writing custom iterators as generator functions is most natural. However, we can also create custom classes that obey the protocol (note: iterator); often these will have other behaviors (i.e., methods) as well, but most such behaviors necessarily rely on statefulness and side effects to be meaningful"</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="kn">from</span> <span class="nn">collections.abc</span> <span class="k">import</span> <span class="n">Iterable</span> 
<span class="k">class</span> <span class="nc">Fibonacci</span><span class="p">(</span><span class="n">Iterable</span><span class="p">):</span>    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>    
    <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>        
        <span class="k">return</span> <span class="bp">self</span>    
    <span class="k">def</span> <span class="nf">__next__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">total</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>        
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>    
    <span class="k">def</span> <span class="nf">running_sum</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>        
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">total</span>
    
<span class="n">fib</span> <span class="o">=</span> <span class="n">Fibonacci</span><span class="p">()</span> 
<span class="c"># fib.running_sum() # 0 </span>
<span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">fib</span><span class="p">):</span> 
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s">" "</span><span class="p">)</span> 
<span class="c"># &gt;&gt;&gt; 1 1 2 3 5 8 13 21 34 55 </span>
<span class="c"># fib.running_sum() # 143 </span>
<span class="c"># next(fib) # 89 </span>

<span class="c"># Note:  a class that both implements the iterator protocol and also provides an additional method to return </span>
<span class="c"># something stateful about its instance. This approach can be usefull but not functional (because statefullness).</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>1 1 2 3 5 8 13 21 34 55 </pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="Module:-itertools">Module: itertools<a class="anchor-link" href="/posts/functional-concepts-for-python/#Module:-itertools">¶</a></h5><p>"The module itertools is a collection of very powerful—and carefully designed—functions for performing iterator algebra. That is, these allow you to combine iterators in sophisticated ways without having to concretely instantiate anything more than is currently required"
<a href="https://docs.python.org/3.5/library/itertools.html">https://docs.python.org/3.5/library/itertools.html</a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [28]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="k">def</span> <span class="nf">fibonacci</span><span class="p">():</span>     
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>      
    <span class="k">while</span> <span class="k">True</span><span class="p">:</span>          
        <span class="k">yield</span> <span class="n">a</span>          
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="o">+</span><span class="n">b</span>

<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">fibonacci</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s">'__iter__'</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">fibonacci</span><span class="p">())</span> <span class="ow">and</span> <span class="s">'__next__'</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">fibonacci</span><span class="p">())</span> <span class="p">)</span>

<span class="kn">from</span> <span class="nn">itertools</span> <span class="k">import</span> <span class="n">tee</span><span class="p">,</span> <span class="n">accumulate</span> 
<span class="n">s</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">tee</span><span class="p">(</span><span class="n">fibonacci</span><span class="p">())</span> 
<span class="n">pairs</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">accumulate</span><span class="p">(</span><span class="n">s</span><span class="p">))</span> 
<span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="p">(</span><span class="n">fib</span><span class="p">,</span> <span class="n">total</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="n">pairs</span><span class="p">):</span>      
    <span class="nb">print</span><span class="p">(</span><span class="n">fib</span><span class="p">,</span> <span class="n">total</span><span class="p">)</span> 

<span class="c"># NOTE: zip(), map(), filter(), and range() (which is, in a sense, just a terminating itertools.count()) could well </span>
<span class="c"># live in itertools if they were not built-ins. That is, all of those functions lazily generate sequential items </span>
<span class="c"># (mostly based on existing iterables) without creating a concrete sequence</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;class 'generator'&gt;
True
1 1
1 2
2 4
3 7
5 12
8 20
13 33
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Higher-Order-Functions">Higher Order Functions<a class="anchor-link" href="/posts/functional-concepts-for-python/#Higher-Order-Functions">¶</a></h3><p>"a higher-order function is simply a function that takes one or more functions as arguments and/or produces a function as a result."</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="c"># Classic "FP-style" </span>
<span class="n">transformed</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="n">tranformation</span><span class="p">,</span> <span class="n">iterator</span><span class="p">)</span> 
<span class="c"># Comprehension </span>
<span class="n">transformed</span> <span class="o">=</span> <span class="p">(</span><span class="n">transformation</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">iterator</span><span class="p">)</span>
<span class="c"># Classic "FP-style" </span>
<span class="n">filtered</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="n">predicate</span><span class="p">,</span> <span class="n">iterator</span><span class="p">)</span> 
<span class="c"># Comprehension </span>
<span class="n">filtered</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">iterator</span> <span class="k">if</span> <span class="n">predicate</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> 
<span class="c"># The function functools.reduce() is very general, very powerful, and very subtle to use to its full power. It takes </span>
<span class="c"># successive items of an iterable, and combines them in some way. The most common use case for reduce() is probably </span>
<span class="c"># covered by the built-in sum(), which is a more compact spelling of:</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="k">import</span> <span class="n">reduce</span> 
<span class="n">total</span> <span class="o">=</span> <span class="n">reduce</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">add</span><span class="p">,</span> <span class="n">it</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> 
<span class="c"># total = sum(it) </span>
<span class="c"># It may or may not be obvious that map() and filter() are also a special cases of reduce(). That is:</span>
<span class="n">add5</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">n</span><span class="p">:</span> <span class="n">n</span><span class="o">+</span><span class="mi">5</span> 
<span class="n">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">l</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">l</span><span class="o">+</span><span class="p">[</span><span class="n">add5</span><span class="p">(</span><span class="n">x</span><span class="p">)],</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="p">[])</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">]</span> 
<span class="c"># simpler: map(add5, range(10)) </span>
<span class="n">isOdd</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">n</span><span class="p">:</span> <span class="n">n</span><span class="o">%</span><span class="k">2</span> 
<span class="n">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">l</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">l</span><span class="o">+</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">if</span> <span class="n">isOdd</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="n">l</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="p">[])</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span> 
<span class="c"># simpler: filter(isOdd, range(10))</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="DECORATORS">DECORATORS<a class="anchor-link" href="/posts/functional-concepts-for-python/#DECORATORS">¶</a></h4><p>"probably the most common use of higher-order functions in Python is as decorators. Decorators in Python are possible 
because:"</p>
<ul>
<li>encapsulation: define a function inside a function, the contained function can access but not assign the container function</li>
<li>functions can be passed as a parameter (functions are first-class objects)</li>
<li>functions can return functions</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [38]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="c"># Taken from: http://thecodeship.com</span>

<span class="k">def</span> <span class="nf">strong_decorate</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
    <span class="sd">'''first decorator'''</span>
    <span class="k">def</span> <span class="nf">func_wrapper</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">"&lt;strong&gt;{0}&lt;/strong&gt;"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">func</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">func_wrapper</span>

<span class="k">def</span> <span class="nf">p_decorate</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
    <span class="sd">'''second decorator'''</span>
    <span class="k">def</span> <span class="nf">func_wrapper</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">"&lt;p&gt;{0}&lt;/p&gt;"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">func</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">func_wrapper</span>

<span class="nd">@strong_decorate</span>
<span class="nd">@p_decorate</span>
<span class="k">def</span> <span class="nf">get_text</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="sd">'''sample function'''</span>
    <span class="k">return</span> <span class="s">"lorem ipsum, {0} dolor sit amet"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

<span class="c">#my_get_text = p_decorate(get_text)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">get_text</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">get_text</span><span class="p">(</span><span class="s">"John"</span><span class="p">))</span>

<span class="c"># A function that takes another function as an argument, generates a new function, augmenting the work of the original </span>
<span class="c"># function, and returning the generated function so we can use it anywhere.</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;function strong_decorate.&lt;locals&gt;.func_wrapper at 0x000000000379AEA0&gt;
&lt;strong&gt;&lt;p&gt;lorem ipsum, John dolor sit amet&lt;/p&gt;&lt;/strong&gt;
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [40]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="c">## Using self and *args and **kargs</span>

<span class="k">def</span> <span class="nf">p_decorate</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
   <span class="k">def</span> <span class="nf">func_wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
       <span class="k">return</span> <span class="s">"&lt;p&gt;{0}&lt;/p&gt;"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
   <span class="k">return</span> <span class="n">func_wrapper</span>

<span class="k">class</span> <span class="nc">Person</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">"John"</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">family</span> <span class="o">=</span> <span class="s">"Doe"</span>

    <span class="nd">@p_decorate</span>
    <span class="k">def</span> <span class="nf">get_fullname</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="s">" "</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">family</span>

<span class="n">my_person</span> <span class="o">=</span> <span class="n">Person</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">my_person</span><span class="o">.</span><span class="n">get_fullname</span><span class="p">())</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;p&gt;John Doe&lt;/p&gt;
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="c">## Passing arguments to decorators</span>

<span class="c"># Looking back at the example before the one above, you can notice how redundant the decorators in the example are. </span>
<span class="c"># 2 decorators each with the same functionality but wrapping the string with different tags. We can definitely do much </span>
<span class="c"># better than that. Why not have a more general implementation for one that takes the tag to wrap with as a string? </span>
<span class="c"># Yes please!</span>

<span class="c">#from functools import wraps</span>

<span class="k">def</span> <span class="nf">tags</span><span class="p">(</span><span class="n">tag_name</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">tags_decorator</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
        <span class="c">#@wraps(func)</span>
        <span class="k">def</span> <span class="nf">func_wrapper</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
            <span class="sd">""" this is a closure """</span>
            <span class="k">return</span> <span class="s">"&lt;{0}&gt;{1}&lt;/{0}&gt;"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tag_name</span><span class="p">,</span> <span class="n">func</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">func_wrapper</span>
    <span class="k">return</span> <span class="n">tags_decorator</span>

<span class="nd">@tags</span><span class="p">(</span><span class="s">"p"</span><span class="p">)</span>
<span class="nd">@tags</span><span class="p">(</span><span class="s">"strong"</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">get_text</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="k">return</span> <span class="s">"Hello "</span><span class="o">+</span><span class="n">name</span>

<span class="nb">print</span><span class="p">(</span><span class="n">get_text</span><span class="p">(</span><span class="s">"John"</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">get_text</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span> <span class="c"># print the closure name</span>

<span class="c"># NOTE: try to uncomment the import and the "wraps" decorator and see how the outer function name is printed properly </span>
<span class="c"># (good for debugging).</span>

<span class="c"># Links:</span>
<span class="c"># https://github.com/mjhea0/python-decorators</span>
<span class="c"># http://simeonfranklin.com/blog/2012/jul/1/python-decorators-in-12-steps/</span>
<span class="c"># https://wiki.python.org/moin/PythonDecorators#What_is_a_Decorator</span>
<span class="c">## A guide to develop with Decorators:</span>
<span class="c"># http://www.artima.com/weblogs/viewpost.jsp?thread=240808</span>
<span class="c"># http://www.artima.com/weblogs/viewpost.jsp?thread=240845</span>
<span class="c"># http://www.artima.com/weblogs/viewpost.jsp?thread=241209</span>
<span class="c"># Lot of examples: https://wiki.python.org/moin/PythonDecoratorLibrary</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;p&gt;&lt;strong&gt;Hello John&lt;/strong&gt;&lt;/p&gt;
func_wrapper
</pre>
</div>
</div>

</div>
</div>

</div>
    </div>
  </div>
</body>
            </div> -->
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/a-collection-of-ideas-and-chunks/">A Collection Of Ideas And Chunks</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2015-07-20T19:00:00+02:00">2015-07-20 19:00</time>
</div>
                <div class="stats">
                    
                </div>
                
            </div>
            <!-- <div class="body">
                <body><p>Hope it is for pyCoders like a good dip made from mashed chickpeas... Yeah, I love hummus (: 
Share with me if you make some great repository from this material. </p></body>
            </div> -->
        </div>
    
    
            
        </div>
    </section><script src="assets/js/all-nocdn.js" type="text/javascript"></script><script type="text/javascript">
            $(function(){
                $('.timeago').timeago();
            });
        </script>
</body>
</html>
